//====================================================================
//ステージトラップスクリプト
//[14021][大鉄塔－武器①]
//====================================================================

#ScriptTable

#UPFLR_Z 	2000

//--------------------------------------------------------------------
//■グローバルフラグ
// 2945 武器② フードスロット
// Fx_422Food1 	木箱 飯

//■ルートフラグ 2096-2192

// 2100 武器③ 中ボス死亡
// 2102 武器① リフト発車
// 2104 武器③ 風船を割った
// 2105 武器③ ⑦ボタンスイッチ

// 2106 武器① フットスイッチを最初に踏んだ

// 2120 武器① ⑧樽

// 2130 武器② ④樽
// 2131 武器② ⑥樽

// 2140 武器③ ⑩樽

// 2150 武器① ①壷
// 2151 武器① ②壷
// 2152 武器① ③壷
// 2153 武器① ④壷

// 2160 武器② ①壷
// 2161 武器② ②壷
// 2162 武器② ③壷

// 2160 武器③ ①壷
// 2161 武器③ ②壷
// 2162 武器③ ③壷
// 2163 武器③ ④ハニワ
// 2164 武器③ ⑤壷
// 2165 武器③ ⑥壷
// 2166 武器③ ⑦壷

// 2180 武器① ③大砲
// 2181 武器① ④大砲
// 2182 武器① ⑤大砲
// 2183 武器① ⑥大砲

// 2190 武器③ ①大砲
// 2191 武器③ ⑬大砲

//■ローカルフラグ
// 101 フットスイッチのどちらかを踏んでいる
// 105,106,107,108,109 路線アニメ用

#TAKARA_CH	49
#IT_TAKARA	111		//◇111ポータブルＴＶ

//--------------------------------------------------------------------
INIT
{
//環境SE

	if(F2_09_GotoTownPoc)
	{
		SE(63,0)
		SE(65,0)
	}

//■地形
	F_set_chr(PLAYER1, CF_NO_FALL )
	F_set_chr(PLAYER2, CF_NO_FALL )
	F_set_chr(PET, CF_NO_FALL )

	set_obj2("mo41000",	 4, 5,     0,-900,   0,   0) //鉄塔縁↑
	set_obj2("mo41000",	 6, 5,     0,-900,   0,   0) //鉄塔縁↑
	set_obj2("mp41000",  5, 4, -1350,-450,   0,   0) //	→
	set_obj2("mp41020",  5, 4, -1350, 450,   0,   0) //	→
	set_obj2("mp41010",  5, 4,  1350,-450,   0,   0) //	←
	set_obj2("mp41030",  5, 4,  1350, 450,   0,   0) //	←

	set_obj("obx0044",	 4, 6,     0,   0,   0,  90) //立体交差用橋
	set_obj("obx0044",	 6, 6,     0,   0,   0,  90) //立体交差用橋
	set_obj("mp41160",	 4, 4,     0,-450,   0,	  0) //歯車
	set_obj("mp41160",	 6, 4,     0,-450,   0,	  0) //歯車

	set_chr(180,991,	 5, 4, -1350,   0,  0,		270,070110, 0,";")	// 空気壁
	set_chr(181,991,	 5, 4,  1350,   0,  0,		 90,070110, 0,";")	// 空気壁

//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
//■階段・扉
	set_chr( 90,990,	 8, 5,     0,   0,  0,		 90,  0102, 6,"K1_14019;")	//①エントリ 中継分岐
	set_obj("@ob40020a", 8, 5,     0,   0,  0,		 90)						//①アーチ（塔）
	set_chr(190,1400,	 8, 5,	   0,   0,  0,		  0,    90, 0,";")			//アーチ（ダミー）

	set_chr( 91,990,	 5, 3,     0,-300,  0,		  0,  0201, 6,"K0_0;")		//②エントリ 武器②
	set_obj("@ob40000a", 5, 3,     0,-300,  0,		  0)						//②階段上（塔）
	set_chr(191,1301,	 5, 3,     0,-300,  0,		  0,     0, 0,";")			//階段上（ダミー）

	// チェックポイント
//	set_chr( 95,990,	 5, 4,  -900,   0,  0,		270,070206, 6,"k5_0")
//	set_chr( 96,990,	 5, 4,   900,   0,  0,		 90,070206, 6,"k6_0")
	set_chr( 97,990,	 4, 5,     0,-900,  0,		  0,070602, 6,"k7_0")
	set_chr( 98,990,	 6, 5,     0,-900,  0,		  0,070602, 6,"k8_0")

	set_chr( 50,500,	 5, 5,     0,-300,  0,		  6,     0, 0,";")	//③扉（塔） 開放
	set_chr( 51,500,	 5, 5,     0, 300,  0,		  6,     0, 0,";")	//④扉（塔） 開放
	set_chr( 52,500,	 5, 5,   300,   0,  0,		  7,    90, 0,";")	//⑤扉（塔） 閉鎖
	set_chr( 53,500,	 5, 5,  -300,   0,  0,		  7,    90, 0,";")	//⑥扉（塔） 閉鎖
	set_chr( 54,500,	 6, 5,   650,   0,  0,		  7,    90, 0,";")	//⑦扉（塔） 閉鎖
	set_chr( 55,500,	 4, 5,  -650,   0,  0,		  7,    90, 0,";")	//⑧扉（塔） 閉鎖
	set_chr( 56,500,	 5, 4,     0,-800,  0,		  7,     0, 0,";")	//⑨扉（塔） 閉鎖

//■スイッチ・看板

	set_chr( 58,656,	 5, 5,  -250, 350, 50,		  4,     0, 0,";")	//①信号
	set_chr( 59,656,	 5, 5,   250,-350, 50,		  4,   180, 0,";")	//②信号

	// フットスイッチと扉
	set_chr(174,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F101 M4_56 WT?15 !F101 M5_56 WT?15);")//扉
	set_chr(175,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"      M2!75 SF101 ")/③フットスイッチ
	set_chr(176,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"RF101 M2!76 SF101")//④フットスイッチ
	set_chr(177,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"L2?7574 M3!75 M3_75")
	set_chr(178,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"L2?7674 M3!76 M3_76")
	set_chr( 75,649,	 5, 4,     0, 450,  0,		  2,     0, 0,"") //③フットスイッチ
	set_chr( 76,649,	 5, 3,     0, 700,  0,		  2,   180, 0,"") //④フットスイッチ
	if ( !F2106 )
	{
		set_chr( 77,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F101 WT?10 O1_18 SF2106;")	// フットスイッチ初回
	} 

	set_chr( 64,665, 7, 5,  -450,-450,  0,		  2,     0, 8,"M3?99 SF2102;")	//④ゴング
	if(WK_ENTRY==91)//階段91 から来た時（帰り）
	{
		F_set(2102)
	}
	if ( !F2102 )
	{
		set_chr( 78,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F2102 WT?08 O1_18;")	// ゴング初回
	}

//■ハニワ・壷

	if ( !F2150 )
	{
		set_chr( 40,802,	 6, 6,     0,   0,  0,		  2,    60, 0,"I_$$$1 SF2150 V4_140;")	//①壷
		set_chr(140,811,	 6, 6,     0,   0,  0,		 -1,    60, 0,";")
	}
	else
	{
		set_chr(140,811,	 6, 6,     0,   0,  0,		  0,    60, 0,";")
	}


	if ( !F2151 )
	{
		set_chr( 41,802,	 4, 6,     0,   0,  0,		  2,   180, 0,"I_$$$1 SF2151 V4_141;")	//②壷
		set_chr(141,811,	 4, 6,     0,   0,  0,		 -1,   180, 0,";")
	}
	else
	{
		set_chr(141,811,	 4, 6,     0,   0,  0,		  0,   180, 0,";")
	}


	if ( !F2152 )
	{
		set_chr( 42,802,	 6, 5,     0,-900,  0,		  2,   315, 0,"I_$$$1 SF2152 V4_142;")	//③壷
		set_chr(142,811,	 6, 5,     0,-900,  0,		 -1,   315, 0,";")
	}
	else
	{
		set_chr(142,811,	 6, 5,     0,-900,  0,		  0,   315, 0,";")
	}


	if ( !F2153 )
	{
		set_chr( 43,802,	 4, 5,     0,-900,  0,		  2,   245, 0,"I_$$$1 SF2153 V4_143;")	//④壷
		set_chr(143,811,	 4, 5,     0,-900,  0,		 -1,   245, 0,";")
	}
	else
	{
		set_chr(143,811,	 4, 5,     0,-900,  0,		  0,   245, 0,";")
	}

//■宝箱
	if(IT_TAKARA<0)
		set_chr( TAKARA_CH,560,	   7, 6,     0,   0,  0,  	   6,    90,20,"<TK_TAKARA>;")		//②宝箱（並）
	else
		set_chr( TAKARA_CH,560,    7, 6,     0,   0,  0,  	   7,    90, 0,";")		//②宝箱（並）


//■罠・障害物
	set_chr(110,673,	 3, 5,  -150,   0,  0,		  2,   270, 0,";")//リフト端[路線A]
	set_chr(111,673,	 7, 5,   150,   0,  0,		  2,    90, 0,";")//リフト端[路線A]
	set_chr(112,653,	 4, 5,  -900,   0,  0,		  2,   270, 0,";")//リフト用ロープa[路線A]
	set_chr(113,653,	 5, 5,  -900,   0,  0,		  2,   270, 0,";")//リフト用ロープb[路線A]
	set_chr(114,653,	 6, 5,  -900,   0,  0,		  2,   270, 0,";")//リフト用ロープc[路線A]
	set_chr(115,653,	 7, 5,  -900,   0,  0,		  2,   270, 0,";")//リフト用ロープd[路線A]

//  -------  no typ     tip      x    y   z    mot  向 状          000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
	set_chr( 60,661,	 7, 5,  -550,   0,  0,		  2,   270, 0,"SF105 (M3_99 RF108 WT?30 SF108 WT?30 X2_-1200 RF105 X2_-800 SF107 X2_-2000 RF107 X2_-700 SF106 X2_-1400 M4_99 RF108 WT?30 SF108 WT?30 X2_1200 RF106 X2_800 SF107 X2_2000 RF107 X2_700 SF105 X2_1400);")//①リフト台[路線A]
	set_chr( 61,662,	 7, 5,  -200,   0,  0,		  2,   270, 0,"      (M3_99       WT?30       WT?30 X2_-1200       X2_-800       X2_-2000       X2_-700       X2_-1400 M4_99       WT?30       WT?30 X2_1200       X2_800       X2_2000       X2_700 SF105 X2_1400);")//①リフト積載台[路線A]
	set_chr( 62,662,	 7, 5,  -900,   0,  0,		  2,   270, 0,"      (M3_99       WT?30       WT?30 X2_-1200       X2_-800       X2_-2000       X2_-700       X2_-1400 M4_99       WT?30       WT?30 X2_1200       X2_800       X2_2000       X2_700 SF105 X2_1400);")//①リフト積載台[路線A]
	set_chr(119,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F2102 WT?30 #8_60 #8_61 #8_62  M3_110 M3_111 M3_112 M3_113 M3_114 M3_115;")

	if ( !F2180 )
	{
		set_chr( 65,810,	 6, 5,     0, 300,  0,		  2,     0, 0,";"); //③大砲
		set_chr(165,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F65 I_$$$2 SF2180;");
	}

	if ( !F2181 )
	{
		set_chr( 66,810,	 6, 5,     0,-300,  0,		  2,     0, 0,";"); //④大砲
		set_chr(166,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F66 I_$$$2 SF2181;");
	}

	if ( !F2182 )
	{
		set_chr( 67,810,	 4, 5,     0, 300,  0,		  2,     0, 0,";"); //⑤大砲
		set_chr(167,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F67 I_$$$2 SF2182;");
	}

	if ( !F2183 )
	{
		set_chr( 68,810,	 4, 5,     0,-300,  0,		  2,     0, 0,";"); //⑥大砲
		set_chr(168,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F68 I_$$$2 SF2183;");
	}


	if ( !F2120 )
		set_chr( 70,630,	 2, 5,     0,   0,  0,		  2,     0, 0,"I_FFF1 SF2120;")	//⑧樽
	else
		set_chr( 70,630,	 2, 5,     0,   0,  0,		  2,     0, 0,"I_$$$1;")	//⑧樽


	set_chr( 74,590,	 5, 7,     0,-100,  0,		  2,     0, 0,"") //⑨重し

	set_chr( 71,809,	 5, 6,     0, 200,  0,		  3,     0, 0,"") //⑩トゲ床

//■敵
	set_chr(  3,103,	 3, 5,     0,-350,  0,		  2,   270, 0,";")//①敵 おーが
	set_chr(  5,215,	 3, 6,   150,   0,  0,		  2,   225, 0,";")//②敵 ふれいむ
	set_chr(  6,115,	 4, 6,     0,   0,320,		  2,   270,	0,";")//③敵 ころにー
	set_chr(  7,147,	 5, 6,  -250, 750,  0,		  2,   180, 0,";")//④敵 あーけろん
	set_chr(  8,115,	 5, 6,   250, 900,  0,		  2,     0,	0,";")//⑤敵 ころにー
	set_chr( 10,103,	 6, 6,  -150,   0,320,		  2,   180, 0,";")//⑥敵 おーが
	set_chr( 11,215,	 5, 4,     0, 550,  0,		  2,   180, 0,";")//⑦敵 ふれいむ
	set_chr( 12,115,	 5, 4,   800,   0,  0,		  2,   270,	0,";")//⑧敵 ころにー

//■イベント

	set_chr( 84,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F105 M4_54 !F105 M5_54);")// 端 ⑦扉 アニメ[路線A]
	set_chr( 85,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F106 M4_55 !F106 M5_55);")// 端 ⑧扉 アニメ[路線A]
	set_chr( 86,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F107 M5_50 M5_51 M4_52 M2_58 M2_58 M4_53 !F107 M4_50 M4_51 M5_52 M5_53 M4_58 M4_58);")// 中央 扉・信号 アニメ[路線A]
	set_chr( 87,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F108 WT?30 SF109 !F108 WT?30 RF109);")// ロープアニメ[路線A]
	set_chr( 88,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F109 M+_110 M+_111 M+_112 M+_113 M+_114 M+_115 M+_116 !F109 M-_110 M-_111 M-_112 M-_113 M-_114 M-_115 M-_116);")//扉アニメ[路線A] 端

	if(GW_ENTRY_EVENT==1)
	{
		workG(GW_ENTRY_EVENT,SET,0)
		//▼燃える扉をくぐった後のイベント・続き
		EV("EV_2_10_GotoTownPoc2")
	}
	else
	if(F1_22_EndFirst && !F2_17_EndSecond)
	{
	//２章
		//ＧＦ『★ポックルたちが町に戻った』立ってない
		if(!F2_09_GotoTownPoc)
		{
			EV("EV_2_10_GotoTownPoc0")
		}
	}

//■場面固有設定

}

//──────────────────────────────
EV_2_10_GotoTownPoc0
{
	EV_begin()

	stop_SE(65)//歯車SEが鳴らないように

	//暗転
	fade_in(100,1,0)
	wait_fade()

	workG(GW_ENTRY_EVENT,SET,1)
	new_map(14019)
}

//──────────────────────────────
//▼燃える扉をくぐった後のイベント・続き
//──────────────────────────────
//　　フェードインして、ルート開始地点にいるラグナたち。
//　　そのまま台詞無しでイベント終了、プレイヤー操作許可。

EV_2_10_GotoTownPoc2
{
//	EV_begin()

	//暗転
	fade_in(100,1,0)
	wait_fade()

	chr_pos(RAGNA,14500,9550,0,90,2)
	chr_pos(PARTNER,14500,9350,0,90,2)
	chr_pos(PET,14600,9450,0,90,0)

	CAM_return(0)

	fade_in(0,30,0)

	SCORE(0,0,0)//念のためスコア初期化
	//ルートスタート
	workG(GW_NOW_ROUTE,SET,53);//軌道連絡駅

	EV_end()

}

#EndScriptTable
//====================================================================

