//====================================================================
//ステージトラップスクリプト
//[11042][廃坑－サブ②]
//====================================================================

#ScriptTable

//--------------------------------------------------------------------
//■グローバルフラグ・ルートフラグはev10412.txt参照

//■ローカルフラグ
// 100 中ボス部屋警報
// 101 どれかの箱を開いた
// 102 ②木箱を開いた
// 103 ③木箱を開いた
// 104 ④木箱を開いた
// 105 ①岩のどれかを壊した
// 106 落盤雑魚一撃死発動中
// 109 中ボスBGM管理

#TAKARA_CH	49
#IT_TAKARA	074			//◇074学者の帽子

//--------------------------------------------------------------------
INIT
{
//■地形

//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
//■階段・扉
	set_chr( 90,990,	 7, 5,  -100,   0,  0,		 90,  0102, 6,"K0_1;")		//①エントリ サブ①
	set_obj("@obx0012a", 7, 5,     0,   0,  0,		 90)						//①階段下（岩）
	set_chr(190,1300,	 7, 5,     0,   0,  0,		  0,    90, 0,";")			//階段下（ダミー）

	set_chr( 91,990,	 5, 5,     0,   0,  0,		  0,  0201, 6,"K0_0;")		//②エントリ サブ③
	set_obj("@obx0002a", 5, 5,     0,   0,  0,		  0)						//②階段上（岩）
	set_chr(191,1301,	 5, 5,     0,   0,  0,		  0,     0, 0,";")			//階段上（ダミー）

	set_chr( 51,502,	 4, 3,     0, 500,  0,		  3,     0, 6,";")	//④扉（岩） 自由
	set_chr( 52,502,	 4, 7,     0,-900,  0,		  6,   180, 0,";")	//⑤扉（岩） 開放
	set_chr( 53,502,	 5, 6,     0,-500,  0,		  3,     0, 6,";")	//⑥扉（岩） 自由
	set_chr( 54,502,	 3, 5,     0,-500,  0,		  7,     0, 0,";")	//⑦扉（岩） 閉鎖

//■スイッチ・看板
	set_chr( 56,658,	 4, 6,  -155, 550,  0,		  0,   270, 0,";")	//①中ボス看板
	set_chr( 57,804,	 5, 7,   275,-175,  0,		  0,   240, 8,"(L2?99 [9991落盤注意] WT?30 L2!99 [9903] WT?30);")	//②看板
	set_chr( 58,657,	 3, 5,  -125,-100,  0,		  0,   270, 0,";")	//③ハテナ看板

//■ハニワ・壷
	if ( !F2160 )
	{
		set_chr( 40,802,	 5, 4,   150,-900,  0,		  2,    60, 0,"I_$$$1 SF2160 V4_140;")	//①壷
		set_chr(140,811,	 5, 4,   150,-900,  0,		 -1,    60, 0,";")
	}
	else
	{
		set_chr(140,811,	 5, 4,   150,-900,  0,		  0,    60, 0,";")
	}


	if ( !F2161 )
	{
		set_chr( 41,802,	 4, 2,   600, 100,  0,		  2,    60, 0,"I_$$$1 SF2161 V4_141;")	//②壷
		set_chr(141,811,	 4, 2,   600, 100,  0,		 -1,    60, 0,";")
	}
	else
	{
		set_chr(141,811,	 4, 2,   600, 100,  0,		  0,    60, 0,";")
	}


	if ( !F2162 )
	{
		set_chr( 42,802,	 3, 6,   150,-900,  0,		  2,   120, 0,"I_$$$1 SF2162 V4_142;")	//③壷
		set_chr(142,811,	 3, 6,   150,-900,  0,		 -1,   120, 0,";")
	}
	else
	{
		set_chr(142,811,	 3, 6,   150,-900,  0,		  0,   120, 0,";")
	}


	if ( !F2163 )
	{
		set_chr( 43,802,	 5, 8,  -150,-900,  0,		  2,    45, 0,"I_$$$1 SF2163 V4_143;")	//④壷
		set_chr(143,811,	 5, 8,  -150,-900,  0,		 -1,    45, 0,";")
	}
	else
	{
		set_chr(143,811,	 5, 8,  -150,-900,  0,		  0,    45, 0,";")
	}


	if ( !F2164 )
	{
		set_chr( 44,802,	 6, 7,  -150,-900,  0,		  2,   135, 0,"I_$$$1 SF2164 V4_144;")	//⑤壷
		set_chr(144,811,	 6, 7,  -150,-900,  0,		 -1,   135, 0,";")
	}
	else
	{
		set_chr(144,811,	 6, 7,  -150,-900,  0,		  0,   135, 0,";")
	}

//■宝箱
	if(IT_TAKARA<1)
		set_chr( TAKARA_CH,560,	   3, 4,     0,   0,  0,	   6,     0,20,"<TK_TAKARA>;")		//②宝箱（並）
	else
		set_chr( TAKARA_CH,560,    3, 4,     0,   0,  0,	   7,     0, 0,";")		//②宝箱（並）


	if ( !F2110 )
	{
		set_chr( 48,562,	 4, 8,   150,-900,  0,		  2,   270, 5,"#8_99 WT?15 !F2110 I_FFF1 SF2110 WT?75 D2_99;")	//②木箱
	}
	else
	{
		set_chr( 48,562,	 4, 8,   150,-900,  0,		  2,   270, 5,";")	//②木箱
	}


	if ( !F2111 )
	{
		set_chr( 47,562,	 5, 8,  -900,-150,  0,		  2,   180, 5,"#8_99 WT?15 !F2111 I_FFF1 SF2111 WT?75 D2_99;")	//③木箱
	}
	else
	{
		set_chr( 47,562,	 5, 8,  -900,-150,  0,		  2,   180, 5,";")	//③木箱
	}


	if ( !F2112 )
	{
		set_chr( 46,562,	 5, 7,  -900, 150,  0,		  2,     0, 5,"#8_99 WT?15 !F2112 I_FFF1 SF2112 WT?75 D2_99;")	//④木箱
	}
	else
	{
		set_chr( 46,562,	 5, 7,  -900, 150,  0,		  2,     0, 5,";")	//④木箱
	}


//■罠・障害物
	set_chr(110,698,	 4, 3,   175,-900,  0,		  0,     0, 0,";")	//柵中

	if ( !F2180 )
	{
		set_chr( 66,642,	 5, 7,  -300,   0,  0,		  2,     0, 0,"I_$$$2 SF2180 SF105;")	//①岩a
	}

	if ( !F2181 )
	{
		set_chr( 67,642,	 5, 7,     0, 300,  0,		  2,     0, 0,"I_$$$2 SF2181 SF105;")	//①岩b
	}

	if ( !F2182 )
	{
		set_chr( 68,642,	 5, 7,   -50,-250,  0,		  2,     0, 0,"I_$$$2 SF2182 SF105;")	//①岩c
	}

	if ( !F2183 )
	{
		set_chr( 69,642,	 5, 7,   150,  50,  0,		  2,     0, 0,"I_$$$2 SF2183 SF105;")	//①岩d
	}

	if ( !F2184 )
		set_chr( 70,631,	 6, 6,  -100, 500,  0,		  2,   275, 0,"I_BBB1 I_BBB1 I_BBB1 SF2184;")	//②爆弾タル
	else
		set_chr( 70,631,	 6, 6,  -100, 500,  0,		  2,   275, 0,"I_BBB1 I_BBB1 I_BBB1;")	//②爆弾タル

//■敵
	set_chr( 1,139,		 6, 4,  -900,-150,  0,		 -1,   270, 8,"L6?9900 V3_99;") //①敵 すなもぐら
	set_chr( 3,216,		 6, 3,  -300, 900,  0,		  2,    45, 0,";") //②敵a あーす
	set_chr( 4,216,		 6, 3,  -150, 450,  0,		  2,     0, 0,";") //②敵b あーす
	set_chr( 5,216,		 6, 3,     0, 900,  0,		  2,   315, 0,";") //②敵c あーす

	set_chr( 7,139,		 5, 3,  -200,-650,  0,		 -1,     0, 8,"L6?9900 V3_99;") //③敵 すなもぐら
	set_chr( 8,112,		 5, 3,  -900,  25,  0,		  2,   180, 0,";") //④敵 じらいいわ
	set_chr( 9,112,		 4, 3,    25,-600,  0,		  2,     0, 0,";") //⑩敵 じらいいわ
	set_chr(11,139,		 4, 4,     0, 200,  0,		 -1,   180, 8,"L6?9900 V3_99;") //⑤敵 すなもぐら

	set_chr(12,139,		 4, 5,  -900, 150,  0,		 -1,   270, 8,"L6?9900 V3_99;") //⑥敵 すなもぐら
	set_chr(13,139,		 4, 6,  -900,-150,  0,		 -1,   270, 8,"L6?9900 V3_99;") //⑦敵 すなもぐら
	set_chr(14,209,		 4, 5,     0,-200,  0,		  2,   180, 0,";") //⑪敵 ごーれむ
	set_chr(15,209,		 4, 6,   -75,-900,  0,		  2,     0, 0,";") //⑧敵 ごーれむ

	set_chr(16,112,		 5, 6,     0,-250,  0,		  2,   180, 0,";") //⑨敵a じらいいわ
	set_chr(17,112,		 5, 6,     0,-750,  0,		  2,     0, 0,";") //⑨敵b じらいいわ
	set_chr(18,216,		 5, 6,   125, 175,  0,		  2,    90, 0,";") //⑨敵c あーす


	if ( !F2100 )
	{
		set_chr(25,352,		 4, 8,   150,-900, 50,		 -1,    45, 8,"F102 WT?01 V3_99;") //⑫敵a べびーごーれむ
		set_chr(26,352,		 4, 8,   150,-900, 50,		 -1,   135, 8,"F102 WT?08 V3_99;") //⑫敵b べびーごーれむ
		set_chr(27,352,		 4, 8,   150,-900, 50,		 -1,   225, 8,"F102 WT?15 V3_99;") //⑫敵c べびーごーれむ
		set_chr(28,352,		 4, 8,   150,-900, 50,		 -1,   315, 8,"F102 WT?22 V3_99;") //⑫敵d べびーごーれむ

		set_chr(30,352,		 5, 8,  -900,-150, 50,		 -1,    45, 8,"F103 WT?01 V3_99;") //⑬敵a べびーごーれむ
		set_chr(31,352,		 5, 8,  -900,-150, 50,		 -1,   135, 8,"F103 WT?08 V3_99;") //⑬敵b べびーごーれむ
		set_chr(32,352,		 5, 8,  -900,-150, 50,		 -1,   225, 8,"F103 WT?15 V3_99;") //⑬敵c べびーごーれむ
		set_chr(33,352,		 5, 8,  -900,-150, 50,		 -1,   315, 8,"F103 WT?22 V3_99;") //⑬敵d べびーごーれむ

		set_chr(35,352,		 5, 7,  -900, 150, 50,		 -1,    45, 8,"F104 WT?01 V3_99;") //⑭敵a べびーごーれむ
		set_chr(36,352,		 5, 7,  -900, 150, 50,		 -1,   135, 8,"F104 WT?08 V3_99;") //⑭敵b べびーごーれむ
		set_chr(37,352,		 5, 7,  -900, 150, 50,		 -1,   225, 8,"F104 WT?15 V3_99;") //⑭敵c べびーごーれむ
		set_chr(38,352,		 5, 7,  -900, 150, 50,		 -1,   315, 8,"F104 WT?22 V3_99;") //⑭敵d べびーごーれむ

		F_set_chr( 25, CF_NO_CLIP2)
		F_set_chr( 26, CF_NO_CLIP2)
		F_set_chr( 27, CF_NO_CLIP2)
		F_set_chr( 28, CF_NO_CLIP2)

		F_set_chr( 30, CF_NO_CLIP2)
		F_set_chr( 31, CF_NO_CLIP2)
		F_set_chr( 32, CF_NO_CLIP2)
		F_set_chr( 33, CF_NO_CLIP2)

		F_set_chr( 35, CF_NO_CLIP2)
		F_set_chr( 36, CF_NO_CLIP2)
		F_set_chr( 37, CF_NO_CLIP2)
		F_set_chr( 38, CF_NO_CLIP2)

//■イベント
		set_chr( 80,990,	 4, 7,     0,-100,  0,		  0,  0501, 6,"SF100;")// 中ボス部屋 入口 戦闘開始エリア 
		set_chr( 81,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F100 S0_1 WT?120;")//警報出現
		// 裏口から入ったら警報を出さない
		set_chr( 82,990,	 5, 7,  -350,  50,  0,		  0,  0105, 6,"#0_80;")// 中ボス部屋 裏口 戦闘開始エリア 
		set_chr( 83,990,	 5, 7,   -50, 350,  0,		  0,  0501, 6,"#0_80;")// 中ボス部屋 裏口 戦闘開始エリア 

		set_chr(111,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F101 M5_52;"); // 扉を閉じる
		set_chr(112,990,	 4, 8,   150,-900,  0,		  0,     0, 8,"F102 SF101 M2?48 M1_48 !F2110 I_FFF1 SF2110 WT?90 D2_48;"); // ②木箱を開ける（最初の箱が開けられた後）
		set_chr(113,990,	 5, 8,  -900,-150,  0,		  0,     0, 8,"F103 SF101 M2?47 M1_47 !F2111 I_FFF1 SF2111 WT?90 D2_47;"); // ③木箱を開ける（最初の箱が開けられた後）
		set_chr(114,990,	 5, 7,  -900, 150,  0,		  0,     0, 8,"F104 SF101 M2?46 M1_46 !F2112 I_FFF1 SF2112 WT?90 D2_46;"); // ④木箱を開ける（最初の箱が開けられた後）
		set_chr(115,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"M2!48 WT?20 SF101 SF102 WT?90 SF103 SF104;")// ②木箱開き待ち ⑫敵出現
		set_chr(116,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"M2!47 WT?20 SF101 SF103 WT?90 SF102 SF104;")// ③木箱開き待ち ⑬敵出現
		set_chr(117,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"M2!46 WT?20 SF101 SF104 WT?90 SF102 SF103;")// ④木箱開き待ち ⑭敵出現
		set_chr(118,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F25 F26 F27 F28 F30 F31 F32 F33 F35 F36 F37 F38 WT?10 SF2100 O1_18 <EV_NormalBGM> WT?30 C0_54 WT?20 M4_54 M4_52 WT?30 C0_0;")// ⑦扉⑤扉 開き待ち 中ボス戦闘終了

		// 中ボスBGM
		set_chr(130,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F109 <EV_BossBGM> WT?90 !F101 !F109 <EV_NormalBGM> WT?90);");
		set_chr(131,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"!F2100 F101 SF109");	// ボスが生きていて、ボス戦闘中ならば109をセット
		set_chr(132,990,	 4, 7,   900, 900,  0,		  0,072121, 6,"!F2100 F100 SF109");	// ボスが生きていて、ボス部屋内ならば109をセット
		set_chr(133,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"RF109");				// 109をクリア
	}
	else
	{
		set_chr(118,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"M6_54;")// ⑦扉 開き
	}

//■イベント

	set_chr( 85,990,	-1,-1,  9450,13075, 0,		  0,     0, 8,"F105 #6_84 WT?120 e9_2160 E0_21540 WT?30 SF106 WT?120 RF106;")// 落盤・どれかの岩を壊したら

	// 106 落盤雑魚一撃死発動中
	// 1,3,4,5,7,8,9,11
	set_chr(151,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F01 L4?9901 D1_01;")
	set_chr(153,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F03 L4?9903 D1_03;")
	set_chr(154,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F04 L4?9904 D1_04;")
	set_chr(155,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F05 L4?9905 D1_05;")
	set_chr(157,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F07 L4?9907 D1_07;")
	set_chr(158,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F08 L4?9908 D1_08;")
	set_chr(159,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F09 L4?9909 D1_09;")
	set_chr(161,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F11 L4?9911 D1_11;")

	// 12,13,14,15,16,17,18
	set_chr(162,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F12 L4?9912 D1_12;")
	set_chr(163,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F13 L4?9913 D1_13;")
	set_chr(164,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F14 L4?9914 D1_14;")
	set_chr(165,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F15 L4?9915 D1_15;")
	set_chr(166,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F16 L4?9916 D1_16;")
	set_chr(167,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F17 L4?9917 D1_17;")
	set_chr(168,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F18 L4?9918 D1_18;")

	// 25,26,27,28,30,31,32,33,35,36,37,38
	set_chr(175,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F25 L4?9925 D1_25;")
	set_chr(176,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F26 L4?9926 D1_26;")
	set_chr(177,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F27 L4?9927 D1_27;")
	set_chr(178,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F28 L4?9928 D1_28;")
	set_chr(180,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F30 L4?9930 D1_30;")
	set_chr(181,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F31 L4?9931 D1_31;")
	set_chr(182,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F32 L4?9932 D1_32;")
	set_chr(183,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F33 L4?9933 D1_33;")
	set_chr(185,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F35 L4?9935 D1_35;")
	set_chr(186,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F36 L4?9936 D1_36;")
	set_chr(187,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F37 L4?9937 D1_37;")
	set_chr(188,990,	-1,-1,  9450,13075,  0,		  0,     0, 9,"F106 !F38 L4?9938 D1_38;")

//■地形

//■場面固有設定
	map_color(100,100,100,0);//R,G,B, time 100%
	map_spotbmp(60);//100%
}

//--------------------------------------------------------------------
EV_BossBGM
{
	stop_BGM(30)
	wait(30)
	BGM(35)
}

//--------------------------------------------------------------------
EV_NormalBGM
{
	stop_BGM(30)
	wait(30)
	BGM(21)
}

#EndScriptTable
//====================================================================

