//====================================================================
//ステージトラップスクリプト
//[16023][山－武器③]
//====================================================================

#ScriptTable

//--------------------------------------------------------------------
//■グローバルフラグ・ルートフラグはev60211.txt参照

//■ローカルフラグ
// 104 中ボス警報
// 105 中ボス出現
// 106 中ボスBGM管理

#TREASURE_CH	48
#Fx_TREASURE	2331	//☆031肉食竜の後足

#TREASURE2_CH	48
#Fx_TREASURE2	2339	//☆039角竜の後足

#WOODBOX_CH		47
#IT_WOODBOX		174		//∴174カルボナーラ

//--------------------------------------------------------------------
INIT
{
//環境SE
	SE(51,0)

//■地形
	set_obj("obx011k",	 6, 3,   900, -50,  0,   180) //三角やぐら
	set_obj("obx011k",	 6, 3,   -50, 900,  0,    90) //三角やぐら
	set_obj("obx011k",	 7, 4,  -900,  50,  0,     0) //三角やぐら
	set_obj("obx011k",	 7, 4,    50,-900,  0,   270) //三角やぐら

	set_obj("obx011k",	 7, 5,   900, -50,  0,   180) //三角やぐら
	set_obj("obx011k",	 7, 5,   -50, 900,  0,    90) //三角やぐら
	set_obj("obx011k",	 8, 6,  -900,  50,  0,     0) //三角やぐら
	set_obj("obx011k",	 8, 6,    50,-900,  0,   270) //三角やぐら

	set_obj("obx011k",	 5, 7,   900, -50,  0,   180) //三角やぐら
	set_obj("obx011k",	 5, 7,   -50, 900,  0,    90) //三角やぐら
	set_obj("obx011k",	 6, 8,  -900,  50,  0,     0) //三角やぐら
	set_obj("obx011k",	 6, 8,    50,-900,  0,   270) //三角やぐら


//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
//■階段・扉
	set_chr( 90,990,	 4, 2,     0,   0,  0,		270,  0102, 6,"K0_1;")		//①エントリ 武器②
	set_obj("@ob61011a", 4, 2,     0,   0,  0,		270)						//①階段下（山）
	set_chr(190,1300,	 4, 2,	   0,   0,  0,		  0,   270, 0,";")			//階段下（ダミー）

	set_chr( 91,990,	 4,10,     0,   0,  0,		180,  0201, 6,"K0_16029;")	//②エントリ 武器終
	set_obj("@ob61031a", 4,10,     0,   0,  0,		180)						//②アーチ（山）
	set_chr(109,622,	 4,10,     0,   0,  0,		  0,   180, 0,";")			//②ゴール用天使
	set_chr(191,1400,	 4,10,	   0,   0,  0,		  0,   180, 0,";")			//アーチ（ダミー）

	set_chr( 50,1207,	 6, 5,     0,-500,  0,		  7,     0, 0,";")	//③扉（山２）閉鎖
	set_chr( 51,1207,	 6, 5,   500,   0,  0,		  7,    90, 0,";")	//④扉（山２）閉鎖
	set_chr( 52,1207,	 6, 6,   500,   0,  0,		  7,    90, 0,";")	//⑤扉（山２）閉鎖
	set_chr( 53,1207,	 6, 6,     0, 500,  0,		  7,   180, 0,";")	//⑥扉（山２）閉鎖
	set_chr( 54,1207,	 7, 7,     0,-900,  0,		  8,     0, 6,";")	//⑦扉（山２）一通
	set_chr( 55,1207,	 5, 5,  -500,   0,  0,		  7,    90, 0,";")	//⑧扉（山２）閉鎖

//■スイッチ・看板
	set_chr( 57,571,	 7, 5,   900, 900,475,		  6,     0, 3,"M6?99 M5_99 SF115;")	//①レバースイッチ
	set_chr( 58,658,	 6, 5,   225,-225,  0,		  0,   225, 0,";")	//②中ボス看板
	set_chr( 59,658,	 6, 6,   225, 225,  0,		  0,   315, 0,";")	//②中ボス看板
	set_chr( 60,804,	 5, 3,   450, 450,  0,		  0,   135, 8,"(L2?99 [9991納涼盆踊り大会] WT?30 L2!99 [9903] WT?30);")	//③看板

//■ハニワ・壷

	if ( !F2145 )
	{
		set_chr( 70,802,	 6, 5,    50,-900,  0,		  2,   120, 0,"I_$$$1 SF2145 V4_170;")	//①壷
		set_chr(170,811,	 6, 5,    50,-900,  0,		 -1,   120, 0,";")
	}
	else
	{
		set_chr(170,811,	 6, 5,    50,-900,  0,		  0,   120, 0,";")
	}


	if ( !F2146 )
	{
		set_chr( 71,634,	 8, 6,  -900,  50,525,		  2,    45, 0,"I_US01 SF2146 V4_171;")	//②ハニワ
		set_chr(171,812,	 8, 6,  -900,  50,525,		 -1,    45, 0,";")
	}
	else
	{
		set_chr(171,812,	 8, 6,  -900,  50,525,		  0,    45, 0,";")
	}


	if ( !F2147 )
	{
		set_chr( 72,802,	 7, 7,   -50, -50,  0,		  2,   245, 0,"I_$$$1 SF2147 V4_172;")	//③壷
		set_chr(172,811,	 7, 7,   -50, -50,  0,		 -1,   245, 0,";")
	}
	else
	{
		set_chr(172,811,	 7, 7,   -50, -50,  0,		  0,   245, 0,";")
	}




	if ( !F2167 )
	{
		set_chr( 40,803,	 6, 3,   900, 900,225,		  0,     0, 0,"SF2167;")
		chr_scale(40,	"root",	225,225,225,		0,	0);
	}

	if ( !F2168 )
	{
		set_chr( 41,803,	 7, 5,   900, 900,225,		  0,     0, 0,"SF2168;")
		chr_scale(41,	"root",	225,225,225,		0,	0);
	}
	set_chr(192,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F2168 <EV_SwitchFall> WT?24 #5_57;")

	if ( !F2169 )
	{
		set_chr( 42,803,	 5, 7,   900, 900,225,		  0,     0, 0,"SF2169;")
		chr_scale(42,	"root",	225,225,225,		0,	0);
	}
	set_chr(193,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"#3_47 F2169 <EV_BoxFall> WT?24 #5_47;")

	if ( !F2170 )
	{
		set_chr(120,803,	 6, 3,   900, 200,365,		  0,     0, 8,"I_$$$1 SF2170;")	//①紅白壷↑
	}

	if ( !F2171 )
	{
		set_chr(121,803,	 6, 3,   900, 450,365,		  0,   270, 0,"I_$$$1 SF2171;")	//②紅白壷↑
	}

	if ( !F2172 )
	{
		set_chr(122,803,	 6, 3,   200, 900,365,		  0,   180, 0,"I_$$$1 SF2172;")	//③紅白壷←
	}

	if ( !F2173 )
	{
		set_chr(123,803,	 6, 3,   450, 900,365,		  0,   180, 0,"I_$$$1 SF2173;")	//④紅白壷←
	}

	if ( !F2174 )
	{
		set_chr(124,803,	 7, 4,  -900,-200,365,		  0,    90, 0,"I_$$$1 SF2174;")	//⑤紅白壷↓
	}

	if ( !F2175 )
	{
		set_chr(125,803,	 7, 4,  -900,-450,365,		  0,    90, 0,"V1_23 SF2175;")		//⑥紅白壷↓
	}

	if ( !F2176 )
	{
		set_chr(126,803,	 7, 4,  -200,-900,365,		  0,     0, 0,"V1_24 SF2176;")		//⑦紅白壷→
	}

	if ( !F2177 )
	{
		set_chr(127,803,	 7, 4,  -450,-900,365,		  0,     0, 0,"I_$$$1 SF2177;")	//⑧紅白壷→
	}


	if ( !F2180 )
	{
		set_chr(130,803,	 7, 5,   900, 200,365,		  0,   270, 0,"V1_25 SF2180;")		//⑨紅白壷↑
	}

	if ( !F2181 )
	{
		set_chr(131,803,	 7, 5,   900, 450,365,		  0,   270, 0,"I_$$$1 SF2181;")	//⑩紅白壷↑
	}

	if ( !F2182 )
	{
		set_chr(132,803,	 7, 5,   200, 900,365,		  0,   180, 0,"I_$$$1 SF2182;")	//⑪紅白壷←
	}

	if ( !F2183 )
	{
		set_chr(133,803,	 7, 5,   450, 900,365,		  0,   180, 0,"I_$$$1 SF2183;")	//⑫紅白壷←
	}

	if ( !F2184 )
	{
		set_chr(134,803,	 8, 6,  -900,-200,365,		  0,    90, 0,"V1_26 SF2184;")		//⑬紅白壷↓
	}

	if ( !F2185 )
	{
		set_chr(135,803,	 8, 6,  -900,-450,365,		  0,    90, 0,"I_$$$1 SF2185;")	//⑭紅白壷↓
	}

	if ( !F2186 )
	{
		set_chr(136,803,	 8, 6,  -200,-900,365,		  0,     0, 0,"I_$$$1 SF2186;")	//⑮紅白壷→
	}

	if ( !F2187 )
	{
		set_chr(137,803,	 8, 6,  -450,-900,365,		  0,     0, 0,"I_$$$1 SF2187;")	//⑯紅白壷→
	}


	if ( !F2190 )
	{
		set_chr(140,803,	 5, 7,   900, 200,365,		  0,   270, 0,"V1_27 SF2190;")		//⑰紅白壷↑
	}

	if ( !F2191 )
	{
		set_chr(141,803,	 5, 7,   900, 450,365,		  0,   270, 0,"I_$$$1 SF2191;")	//⑱紅白壷↑
	}

	if ( !F2192 )
	{
		set_chr(142,803,	 5, 7,   200, 900,365,		  0,   180, 0,"I_$$$1 SF2192;")	//⑲紅白壷←
	}

	if ( !F2193 )
	{
		set_chr(143,803,	 5, 7,   450, 900,365,		  0,   180, 0,"V1_28 SF2193;")		//⑳紅白壷←
	}

	if ( !F2194 )
	{
		set_chr(144,803,	 6, 8,  -900,-200,365,		  0,    90, 0,"I_$$$1 SF2194;")	//⑳①紅白壷↓
	}

	if ( !F2195 )
	{
		set_chr(145,803,	 6, 8,  -900,-450,365,		  0,    90, 0,"I_$$$1 SF2195;")	//⑳②紅白壷↓
	}

	if ( !F2196 )
	{
		set_chr(146,803,	 6, 8,  -200,-900,365,		  0,     0, 0,"I_$$$1 SF2196;")	//⑳③紅白壷→
	}

	if ( !F2197 )
	{
		set_chr(147,803,	 6, 8,  -450,-900,365,		  0,     0, 0,"V1_29 SF2197;")		//⑳④紅白壷→
	}


//■宝箱
	set_chr( 49,626,	 4, 9,     0,   0,  0,		  0,   270,10,"!F2975 I_SLOT SF2975 <EV_SlotDarken>;")	//①スロットマシン
	if ( F2975 )
	{
		MOT( 49, 3, 1);
		EV("EV_SlotDarken")
	}

	// ②宝箱
	if ( GW_LV_PLATE==0 )
	{
		if( !Fx_TREASURE )
			set_chr( TREASURE_CH,561,	 4, 5,     0,   0,  0,  	 6,   0,20,"<TK_TREASURE>;")
		else
			set_chr( TREASURE_CH,561,	 4, 5,     0,   0,  0,  	 7,   0, 0,";")
	}
	else
	{
		if( !Fx_TREASURE2 )
			set_chr( TREASURE2_CH,561,	 4, 5,     0,   0,  0,  	 6,   0,20,"<TK_TREASURE2>;")
		else
			set_chr( TREASURE2_CH,561,	 4, 5,     0,   0,  0,  	 7,   0, 0,";")
	}

	if ( !Fx_623Food1 )
	{
		set_chr( WOODBOX_CH,562,	5, 7,   900, 900,492,		  6,   270,20,"<TK_WOODBOX><EV_SetGetFood1>;")	//③木箱
	}
	else
	{
		set_chr( WOODBOX_CH,562,	5, 7,   900, 900,492,		  7,   270, 0,";")	//③木箱
	}



//■罠・障害物

	set_chr(110,653,	 6, 3,   900, 900,110,		  2,     0, 0,";")//リフト用ロープA縦
	set_chr(111,653,	 6, 3,   900, 900,105,		  2,    90, 0,";")//リフト用ロープA横

	set_chr(112,653,	 7, 5,   900, 900,110,		  2,     0, 0,";")//リフト用ロープB縦
	set_chr(113,653,	 7, 5,   900, 900,105,		  2,    90, 0,";")//リフト用ロープB横

	set_chr(114,653,	 5, 7,   900, 900,110,		  2,     0, 0,";")//リフト用ロープC縦
	set_chr(115,653,	 5, 7,   900, 900,105,		  2,    90, 0,";")//リフト用ロープC横


	if ( !F2140 )
	{
		set_chr( 73,642,	 7, 5,     0,-700,  0,		  2,     0, 0,"I_$$$2 SF2140;")	//⑮岩a
	}

	if ( !F2141 )
	{
		set_chr( 74,642,	 7, 5,   450,-700,  0,		  2,     0, 0,"I_$$$2 SF2141;")	//⑮岩b
	}

	if ( !F2142 )
	{
		set_chr( 75,642,	 7, 4,   220, 700,  0,		  2,     0, 0,"I_$$$2 SF2142;")	//⑮岩c
	}

//■敵
	if ( !F2100 )
	{
		set_chr(  1,371,	 5, 5,   300, 900,  0,		 -1,   270, 8,"F105 V3_99 #8_99 <EV_BossItemSpawner> WT?30 <EV_WakeUpChildren>;")	//①敵 びっぐいえてぃ

		set_chr(  2,231,	 5, 5,   750, 250,  0,		 -2,   350, 0,";")	//①敵a こどもいえてぃ
		set_chr(  3,231,	 5, 5,  1000, 250,  0,		 -2,    10, 0,";")	//①敵b こどもいえてぃ
		set_chr(  4,231,	 5, 5,   750,1550,  0,		 -2,   190, 0,";")	//①敵c こどもいえてぃ
		set_chr(  5,231,	 5, 5,  1000,1550,  0,		 -2,   170, 0,";")	//①敵d こどもいえてぃ

		set_chr( 80,990,	 6, 5,   -50, 900,  0,		  0,  0623, 6,"SF104;")//①敵 中ボス部屋
		set_chr( 81,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F104 S0_1 WT?120 #6_82;")//警報出現
		set_chr( 82,990,	 5, 5,   900, 900,  0,		  0,072323, 0,"SF105 M5_50 M5_51 M5_52 M5_53;")//中ボス出現

		set_chr( 83,990, 0, 0,     0,   0,  0,		  0,     0, 8,"F1 WT?10 O1_18 SF2100 <EV_NormalBGM> WT?30 C0_55 WT?20 M4_50 M4_51 M4_52 M4_53 M4_55 WT?30 C0_0;")//中ボス戦闘終了判定

		// 中ボスBGM
		set_chr(116,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F106 <EV_BossBGM> WT?90 !F105 !F106 <EV_NormalBGM> WT?90);");
		set_chr(117,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"!F2100 F105 SF106");	// ボスが生きていて、ボス戦闘中ならば106をセット
		set_chr(118,990,	 5, 5,   900, 900,  0,		  0,072323, 6,"!F2100 SF106");		// ボスが生きていて、ボス部屋内ならば106をセット
		set_chr(119,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"RF106");				// 106をクリア
	}
	else
	{
		MOT( 55, 6, 1)
	}

	set_chr( 30,372,	 6, 3,   900, 900,375,		 -1,   180, 8,"F2167 V1_99;")  // ②敵a ちびちょうちん
	set_chr( 31,372,	 6, 3,   900, 850,275,		 -1,   180, 8,"F2167 V1_99;")  // ②敵b ちびちょうちん
	set_chr( 32,372,	 6, 3,   850, 900,355,		 -1,    90, 8,"F2167 V1_99;")  // ②敵c ちびちょうちん
	set_chr( 33,372,	 6, 3,   900, 950,295,		 -1,     0, 8,"F2167 V1_99;")  // ②敵d ちびちょうちん
	set_chr( 34,372,	 6, 3,   950, 900,335,		 -1,   270, 8,"F2167 V1_99;")  // ②敵e ちびちょうちん
	set_chr( 35,372,	 6, 3,   900, 900,225,		 -1,     0, 8,"F2167 V1_99;")  // ②敵f ちびちょうちん

	set_chr( 10,231,	 6, 3,   900, 400,  0,		  2,   270, 0,";")	//③敵a こどもいえてぃ
		chr_equip2(10,	"eq_164",	"Bone_Head", 95,		30,0,0,	0,25,-10);				// 花笠青
	set_chr( 11,213,	 6, 3,  1200,1200,  0,		  2,   270, 0,";")	//③敵b おとないえてぃ
		chr_equip2(11,	"eq_165",	"Bone_Head",120,		30,0,0,	0,25,-15);				// 花笠桃
	set_chr( 12,213,	 6, 3,   600,1200,  0,		  2,   270, 0,";")	//③敵b おとないえてぃ
		chr_equip2(12,	"eq_164",	"Bone_Head",120,		30,0,0,	0,25,-15);				// 花笠青

	set_chr( 14,213,	 7, 5,   600, 600,  0,		  2,   270, 0,";")	//④敵a おとないえてぃ
		chr_equip2(14,	"eq_165",	"Bone_LeftHand", 95,		135, 0, 45,	-35, 35,  0);	// 花笠桃
	set_chr( 15,213,	 7, 5,  1200, 600,  0,		  2,   270, 0,";")	//④敵b おとないえてぃ
		chr_equip2(15,	"eq_164",	"Bone_LeftHand", 95,		135, 0, 45,	-35, 35,  0);	// 花笠青
	set_chr( 16,213,	 7, 5,   900,1400,  0,		  2,   270, 0,";")	//④敵c おとないえてぃ
		chr_equip2(16,	"eq_165",	"Bone_Head",120,		30,0,0,	0,25,-15);				// 花笠桃

	set_chr( 17,213,	 5, 7,  1100, 700,  0,		  2,   270, 0,";")	//⑤敵a おとないえてぃ
		chr_equip2(17,	"eq_164",	"Bone_Head",120,		30,0,0,	0,25,-15);				// 花笠青

	set_chr( 18,231,	 5, 7,   700,1100,  0,		  2,   270, 0,"D0_62;")	//⑤敵b こどもいえてぃ
		set_chr( 62,636, 5, 7,   700,1100,  0,		  2,   180, 8,"M0?99 I_FD06;");	//⑦風船
		chr_equip_chr( 62, 18,"Bone_LeftHand", 100,  	 0,135,-90,		0,25,-10);

	set_chr(  8,231,	 5, 4,   900,   0,  0,		  2,   270, 0,"D1_63;")	//⑥敵 こどもいえてぃ
		set_chr( 63,636, 5, 4,   900,   0,  0,		  2,   180, 8,"M0?99 I_FD32 I_FD33;");	//⑥風船
		chr_equip_chr( 63,  8,"Bone_LeftHand", 100,		 0,135,-90,		0,25,-10);

	set_chr(  9,231,	 7, 4,     0,   0,  0,		  2,     0, 0,"D1_64;")	//⑦敵 こどもいえてぃ
		set_chr( 64,666, 7, 4,     0,   0,  0,		  2,     0, 0,"") //的
		chr_equip_chr( 64,  9,"Bone_LeftHand",  50,		 0,135,-90,		0, 0,-35);

	set_chr(23,282,		 7, 4,  -900,-450,365,		 -1,    90, 0,";") //⑪敵 ちょうちんもどき
	set_chr(24,282,		 7, 4,  -200,-900,365,		 -1,     0, 0,";") //⑫敵 ちょうちんもどき
	set_chr(25,282,		 7, 5,   900, 200,365,		 -1,   270, 0,";") //⑬敵 ちょうちんもどき
	set_chr(26,282,		 8, 6,  -900,-200,365,		 -1,    90, 0,";") //⑭敵 ちょうちんもどき
	set_chr(27,282,		 5, 7,   900, 200,365,		 -1,   270, 0,";") //⑮敵 ちょうちんもどき
	set_chr(28,282,		 5, 7,   450, 900,365,		 -1,   180, 0,";") //⑯敵 ちょうちんもどき
	set_chr(29,282,		 6, 8,  -450,-900,365,		 -1,     0, 0,";") //⑰敵 ちょうちんもどき

//■イベント

	set_chr( 84,990,	 0, 0,     0,  0,   0,		  0,     0, 8,"F115 O1_18 WT?10 C0_58 WT?20 M4_50 M4_51 WT?20 C0_59 WT?20 M4_52 M4_53 WT?30 C0_0;")

//■場面固有設定
	EV("EV_SnowFall")
}

//--------------------------------------------------------------------
EV_BossItemSpawner
{
	set_chr(164,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F1 I_FFF3 I_FFF3 I_FFF3;");
	chr_equip_chr(164, 1,"Bone_Spine", 100,	0,0,0,	0,0,0);
}

//-------------------------------------------------------------------
EV_WakeUpChildren
{
	MOT( 2, 96, 15) //⑧敵 くまこぷたー
	MOT( 3, 96, 15) //⑧敵 こどもいえてぃ
	MOT( 4, 96, 15) //⑧敵 おとないえてぃ
	MOT( 5, 96, 15) //⑧敵 こどもいえてぃ
}

//-------------------------------------------------------------------
EV_SnowFall
{
	EFF_chr(4292, 0, 0,100, -1, "charbase0" )
	wait( 50 )
	loop
}

//--------------------------------------------------------------------
EV_SwitchFall
{
	// スイッチ落下
	jump( 57,2, 24,-100,-100,-475,300)
//	jump( 57,3, 24,-1,-1,0,225)
	wait_move(57)
}

//--------------------------------------------------------------------
EV_BoxFall
{
	// 宝箱落下
	jump( 47,2, 24,-100,100,-475,300)
	wait_move(47)
}

//--------------------------------------------------------------------
EV_SlotDarken
{
	wait(15)
	color2( 49, 70,70,70,0,0,0)		// スロット暗く
}

//--------------------------------------------------------------------
EV_BossBGM
{
	stop_BGM(30)
	wait(30)
	BGM(35)
}

//--------------------------------------------------------------------
EV_NormalBGM
{
	stop_BGM(30)
	wait(30)
	BGM(31)
}

//--------------------------------------------------------------------
EV_SetGetFood1
{
	F_set(Fx_623Food1)
}

#EndScriptTable
//====================================================================

