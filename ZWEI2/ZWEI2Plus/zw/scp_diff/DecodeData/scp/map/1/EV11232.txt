//====================================================================
//ステージトラップスクリプト
//[11023][廃坑－武器③]
//====================================================================

#ScriptTable

//--------------------------------------------------------------------
//■グローバルフラグ・ルートフラグはev10212.txt参照

//■ローカルフラグ
// 100 中ボス警報
// 101 中ボス出現
// 102 中ボス取り巻きザコが出現
// 103 中ボスBGM管理
// 106 路線Aアニメon/off
// 107 路線Bアニメon/off
// 108 路線Cアニメon/off
// 109 路線Dアニメon/off

#TAKARA_CH	48
#IT_TAKARA	230		//◇230アクセスロット①

#WOODBOX_CH		47
#IT_WOODBOX		216		//○216爆弾
#NUM_WOODBOX	3

#WOODBOX2_CH	46
#IT_WOODBOX2	216		//○216爆弾
#NUM_WOODBOX2	3

//--------------------------------------------------------------------
INIT
{
//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
//■階段・扉
	set_chr( 90,990,	 9, 8,   100,   0,  0,		 90,  0102, 6,"K0_1;")		//①エントリ 
	set_obj("@obx1012a", 9, 8,     0,   0,  0,		 90)						//①階段下（岩２）
	set_chr(190,1300,	 9, 8,     0,   0,  0,		  0,    90, 0,";")			//階段下（ダミー）

	set_chr( 91,990,	 2, 8,     0, 150,  0,		180,  0201, 6,"K0_11029;")	//②エントリ 武器終
	set_obj("@obx1032a", 2, 8,     0, 150,  0,		180)						//②アーチ（岩２）
	set_chr(109,622,	 2, 8,     0, 150,  0,		  0,   180, 0,";")	//②ゴール用天使
	set_chr(191,1400,	 2, 8,     0, 150,  0,		  0,   180, 0,";")			//アーチ（ダミー）

	set_chr( 50,1201,	 4, 7,     0,-900,  0,		  3,     0, 6,";")	//③扉（岩２） 自由
	set_chr( 51,1201,	 2, 3,   900,   0,  0,		  6,   270, 0,";")	//④扉（岩２） 開放 中ボス部屋
	set_chr( 52,1201,	 1, 4,     0, 900,  0,		  6,     0, 0,";")	//⑤扉（岩２） 開放 中ボス部屋
	set_chr( 53,1201,	 2, 6,     0, 700,  0,		  3,     0, 6,";")	//⑥扉（岩２） 自由
	set_chr( 54,1201,	 5, 8,     0,-900,  0,		  7,   180, 0,";")	//⑦扉（岩２） 閉鎖
	set_chr( 55,1201,	 1, 3,     0,-450,  0,		  7,   180, 0,";")	//⑧扉（岩２） 閉鎖

//■スイッチ・看板
	set_chr( 56,804,	 4, 2,   -50, 200,  0,		  0,     0, 8,"(L2?99 [9991この先、行き止まり] WT?30 L2!99 [9903] WT?30);")	//①工事中看板-工事中
	set_chr( 57,658,	 3, 3,  -400, 325,  0,		  0,   270, 0,";")	//②中ボス看板
	set_chr( 58,804,	 3, 4,  -100,   0,  0,		  0,   270, 8,"(L2?99 [9991もうすぐ出口] WT?30 L2!99 [9903] WT?30);")	//③看板-

	set_chr( 59,571,	 5, 8,     0,-650,  0,		  6,     0, 5,"M!_99")	//④レバースイッチ
	set_chr(189,571,	 0, 0,     0,   0,  0,		  6,     0, 8,"M6!59 O1_18;")

//■ハニワ・壷
	if ( !F2170 )
	{
		set_chr( 40,634,	 7, 7,   550,-375,  0,		  2,     0, 0,"I_US01 SF2170 V4_140;")	//①ハニワ
		set_chr(140,812,	 7, 7,   550,-375,  0,		 -1,     0, 0,";")
	}
	else
	{
		set_chr(140,812,	 7, 7,   550,-375,  0,		  0,     0, 0,";")
	}


	if ( !F2171 )
	{
		set_chr( 41,802,	 4, 8,   300, 300,  0,		  2,   300, 0,"I_$$$1 SF2171 V4_141;")	//②壷
		set_chr(141,811,	 4, 8,   300, 300,  0,		 -1,   300, 0,";")
	}
	else
	{
		set_chr(141,811,	 4, 8,   300, 300,  0,		  0,   300, 0,";")
	}


	if ( !F2172 )
	{
		set_chr( 42,802,	 5, 9,  -300,-300,  0,		  2,    60, 0,"I_$$$1 SF2172 V4_142;")	//③壷
		set_chr(142,811,	 5, 9,  -300,-300,  0,		 -1,    60, 0,";")
	}
	else
	{
		set_chr(142,811,	 5, 9,  -300,-300,  0,		  0,    60, 0,";")
	}


	if ( !F2173 )
	{
		set_chr( 43,802,	 4, 4,   300, 300,  0,		  2,   250, 0,"I_$$$1 SF2173 V4_143;")	//④壷
		set_chr(143,811,	 4, 4,   300, 300,  0,		 -1,   250, 0,";")
	}
	else
	{
		set_chr(143,811,	 4, 4,   300, 300,  0,		  0,   250, 0,";")
	}


	if ( !F2174 )
	{
		set_chr( 44,802,	 5, 2,     0,-900,  0,		  2,   115, 0,"I_$$$1 SF2174 V4_144;")	//⑤壷
		set_chr(144,811,	 5, 2,     0,-900,  0,		 -1,   115, 0,";")
	}
	else
	{
		set_chr(144,811,	 5, 2,     0,-900,  0,		  0,   115, 0,";")
	}


	if ( !F2175 )
	{
		set_chr( 45,802,	 1, 5,     0,   0,  0,		  2,    75, 0,"I_$$$1 SF2175 V4_145;")	//⑥壷
		set_chr(145,811,	 1, 5,     0,   0,  0,		 -1,    75, 0,";")
	}
	else
	{
		set_chr(145,811,	 1, 5,     0,   0,  0,		  0,    75, 0,";")
	}


//■宝箱
	set_chr( 49,626,	 2, 7,     0,   0,  0,		  0,     0,10,"!F2917 I_SLOT SF2917 <EV_SlotDarken>;")	//①スロットマシン
	if ( F2917 )
	{
		MOT( 49, 3, 1);
		EV("EV_SlotDarken")
	}


	if(IT_TAKARA<1)
		set_chr( TAKARA_CH,560,	   4, 9,  -250, 250,  0,  	   6,   225,20,"<TK_TAKARA>;")		//②宝箱（並）
	else
		set_chr( TAKARA_CH,560,    4, 9,  -250, 250,  0,  	   7,   225, 0,";")		//②宝箱（並）


	if ( !Fx_123Bomb2 )
		set_chr( WOODBOX_CH,562,	 2, 2,     0,   0,  0,		  6,    90,20,"<TK_WOODBOX_X><EV_SetGetBomb2>;")	//③木箱
	else
		set_chr( WOODBOX_CH,562,	 2, 2,     0,   0,  0,		  7,    90, 0,";")	//③木箱


	if ( !Fx_123Bomb3 )
		set_chr( WOODBOX2_CH,562,	 1, 1,     0,   0,  0,		  6,     0,20,"<TK_WOODBOX2_X><EV_SetGetBomb3>;")	//④木箱
	else
		set_chr( WOODBOX2_CH,562,	 1, 1,     0,   0,  0,		  7,     0, 0,";")	//④木箱


//■罠・障害物
	set_chr(125,627,	 7, 7,   700, 350,  0,		  0,   270, 0,";")	//柵小a1
	set_chr(126,627,	 7, 7,   700,-350,  0,		  0,   270, 0,";")	//柵小a2

	// 路線A
	set_chr( 68,661,	 7, 7,  -450,   0,  0,		  2,   270, 8,"M3_99 (SF106 X2_-3600 RF106 M4_99 WT?20 SF106 X2_3600 RF106 M3_99 WT?20);")//③リフト台[路線A]
	set_chr(110,673,	 5, 7,  -900,   0,  0,		  3,   270, 0,";")//リフト端[路線A]
	set_chr(111,673,	 7, 7,     0,   0,  0,		  3,    90, 0,";")//リフト端[路線A]
	set_chr(118,653,	 5, 7,   110,   0,  0,		  3,   270, 0,";")// リフト用ロープa[路線A]
	set_chr(119,653,	 6, 7,   110,   0,  0,		  3,   270, 0,";")// リフト用ロープb[路線A]
	set_chr(120,653,	 7, 7, -1010,   0,  0,		  3,   270, 0,";")// リフト用ロープc[路線A]
	if ( !F2190 )
	{
		set_chr( 69,810,	 7, 7,  -450,   0, 50,		  2,     0, 8,"(X2_-3600 WT?20 X2_3600 WT?20);"); //②大砲[路線A]
		set_chr(169,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F69 I_$$$2 SF2190;");
		chr_equip_chr(169,69,"obx0574:Layer1(1)",  100, 0,0,0,	0,0,45);
	}

	// 路線B
	set_chr( 70,662,	 4, 6,  -300,-300,  0,		  2,    90, 8,"M3_99 (SF107 X1_600 RF107 M4_99 WT?15 SF107 X1_-600 RF107 M3_99 WT?15);"); //④リフト積載台[路線B]
	set_chr(112,673,	 4, 6, -1050,-300,  0,		  3,   270, 0,";")//リフト端[路線B]
	set_chr(113,673,	 4, 6,  1050,-300,  0,		  3,    90, 0,";")//リフト端[路線B]
	set_chr(121,653,	 4, 6,     0,-300,  0,		  3,   270, 0,";")// リフト用ロープ[路線B]

	// 路線C
	set_chr( 72,661,	 4, 5,   300, 300,  0,		  2,   270, 8,"M3_99 (SF108 X1_-600 RF108 M4_99 WT?15 SF108 X1_600 RF108 M3_99 WT?15);"); //⑥リフト台[路線C]
	set_chr(114,673,	 4, 5, -1050, 300,  0,		  3,   270, 0,";")//リフト端[路線C]
	set_chr(115,673,	 4, 5,  1050, 300,  0,		  3,    90, 0,";")//リフト端[路線C]
	set_chr(122,653,	 4, 5,     0, 300,  0,		  3,   270, 0,";")// リフト用ロープ[路線C]
	if ( !F2191 )
	{
		set_chr( 73,810,	 4, 5,   300, 300, 50,		  2,     0, 8,"(X1_-600 WT?15 X1_600 WT?15);"); //⑦大砲[路線C]
		set_chr(173,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F73 I_$$$2 SF2191;");
		chr_equip_chr(173,73,"obx0574:Layer1(1)",  100, 0,0,0,	0,0,45);
	}

	// 路線D
	set_chr( 74,661,	 2, 6,     0,-200,  0,		  2,   180, 8,"M3_99 (SF109 Y2_1450 RF109 M4_99 WT?15 SF109 Y2_-1450 RF109 M3_99 WT?15);"); //⑧リフト台[路線D]
	set_chr(116,673,	 2, 6,     0, 100,  0,		  3,   180, 0,";")//リフト端[路線D]
	set_chr(117,673,	 2, 5,     0,-160,  0,		  3,     0, 0,";")//リフト端[路線D]
	set_chr(123,653,	 2, 5,     0, 850,  0,		  3,   180, 0,";")// リフト用ロープ[路線D]
	if ( !F2192 )
	{
		set_chr( 75,810,	 2, 6,     0,-200, 50,		  2,     0, 8,"(Y2_1450 WT?15 Y2_-1450 WT?15);"); //⑨大砲[路線D]
		set_chr(175,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F75 I_$$$2 SF2192;");
		chr_equip_chr(175,75,"obx0574:Layer1(1)",  100, 0,0,0,	0,0,45);
	}


	if ( !F2193 )
		set_chr( 66,630,	 3, 1,     0,   0,  0,		  2,   270, 0,"I_FFF1 SF2193;")	//⑪樽
	else
		set_chr( 66,630,	 3, 1,     0,   0,  0,		  2,   270, 0,"I_$$$1;")	//⑪樽

//■敵
//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
	set_chr(  1,208,	 7, 7,   400, 300,  0,		  0,     0, 0,";")//①敵a こぼると
		chr_equip2( 1,	"eq_103",	"Bone_Head",	103,		95, 0, 0,	0, 45,  0);		// 工事用安全帽
		chr_equip2( 1,	"eq_014",	"Bone_RightArm",100,		0,-45,0,	0,25,0);	// つるはし
		chr_state_LV( 1, 1);
	set_chr(  2,208,	 7, 7,   400,-300,  0,		  0,     0, 0,";")//①敵b こぼると
		chr_equip2( 2,	"eq_103",	"Bone_Head",	103,		95, 0, 0,	0, 45,  0);		// 工事用安全帽
		chr_equip2( 2,	"eq_015",	"Bone_RightArm",100,		0,-45,0,	0,25,0);	// スコップ
		chr_state_LV( 2, 1);
	set_chr(  3,208,	 8, 7,  -250,-150,  0,		  0,     0, 0,";")//①敵c こぼると
		chr_equip2( 3,	"eq_103",	"Bone_Head",	103,		95, 0, 0,	0, 45,  0);		// 工事用安全帽
		chr_equip2( 3,	"eq_007",	"Bone_RightArm",100,		0,0,0,	0,25,0);	// スパナ
		chr_state_LV( 3, 1);

	set_chr(  4,216,	 4, 7,     0,-450,  0,		  0,   270, 0,";")//②敵 あーす

	set_chr(  6,216,	 5, 8,  -300, 500,  0,		  0,   180, 0,";")//③敵 あーす
	set_chr(  7,209,	 4, 9,     0,   0,  0,		  0,   225, 0,";")//④敵a ゴーレム
	set_chr(  8,100,	 4, 9,   150, 150,  0,		  0,   180, 0,";")//④敵b いわつつき
	set_chr(  9,100,	 4, 9,  -150,-150,  0,		  0,   270, 0,";")//④敵c いわつつき

	set_chr( 21,208,	 4, 5,     0, 800,  0,		  0,   315, 0,";")//⑤敵 こぼると
		chr_equip2( 21,	"eq_103",	"Bone_Head",	103,		95, 0, 0,	0, 45,  0);		// 工事用安全帽
		chr_equip2( 21,	"eq_010",	"Bone_RightArm",100,		0,0,0,	0,25,0);	// フライパン
		chr_state_LV( 21, 1);

	set_chr( 22,208,	 4, 4,   200,-150,  0,		  0,    45, 0,";")//⑥敵 こぼると
		chr_equip2( 22,	"eq_103",	"Bone_Head",	103,		95, 0, 0,	0, 45,  0);		// 工事用安全帽
		chr_equip2( 22,	"eq_013",	"Bone_RightArm",100,		0,0,0,	0,25,0);	// 128tハンマー
		chr_state_LV( 22, 1);

	if ( !F2100 )
	{
		set_chr( 10,357,	 1, 3,   600, 600,  0,		 -1,     0, 8,"F101 SF102 V2_99 <EV_BossItemSpawner>;")//⑦敵 ばっとおじさん
		F_set_chr( 10, CF_NO_CLIP2)
		chr_equip2( 10,	"eq_057",	"Bone_Head", 100,		0,0,0,	0,0,0);		// シルクハット
		chr_equip2( 10,	"eq_166",	"Bone_Head", 110,		270,180,180,	0,0,35);

		set_chr( 11,214,	 1, 3,   450,1350,  0,		 -1,     0, 8,"F102 WT?60 V2_99;")//⑦敵a ばっとくん
		set_chr( 12,214,	 1, 3,  1350,1350,  0,		 -1,    45, 8,"F102 WT?64 V2_99;")//⑦敵b ばっとくん
		set_chr( 13,214,	 1, 3,  1350, 450,  0,		 -1,    90, 8,"F102 WT?68 V2_99;")//⑦敵c ばっとくん
		set_chr( 14,214,	 1, 3,   300, 900,  0,		 -1,   135, 8,"F102 WT?110 V2_99;")//⑦敵d ばっとくん
		set_chr( 15,214,	 1, 3,   900, 300,  0,		 -1,   180, 8,"F102 WT?114 V2_99;")//⑦敵e ばっとくん
		set_chr( 16,214,	 1, 3,  1200,1200,  0,		 -1,   225, 8,"F102 WT?118 V2_99;")//⑦敵f ばっとくん
		set_chr( 17,214,	 1, 3,  1500, 600,  0,		 -1,   270, 8,"F102 WT?160 V2_99;")//⑦敵g ばっとくん
		set_chr( 18,214,	 1, 3,   450, 450,  0,		 -1,   315, 8,"F102 WT?164 V2_99;")//⑦敵h ばっとくん
		set_chr( 19,214,	 1, 3,   600,1500,  0,		 -1,     0, 8,"F102 WT?168 V2_99;")//⑦敵i ばっとくん
		chr_state_LV(11,	1);
		chr_state_LV(12,	1);
		chr_state_LV(13,	1);
		chr_state_LV(14,	1);
		chr_state_LV(15,	1);
		chr_state_LV(16,	1);
		chr_state_LV(17,	1);
		chr_state_LV(18,	1);
		chr_state_LV(19,	1);
		F_set_chr( 11, CF_NO_CLIP2)
		F_set_chr( 12, CF_NO_CLIP2)
		F_set_chr( 13, CF_NO_CLIP2)
		F_set_chr( 14, CF_NO_CLIP2)
		F_set_chr( 15, CF_NO_CLIP2)
		F_set_chr( 16, CF_NO_CLIP2)
		F_set_chr( 17, CF_NO_CLIP2)
		F_set_chr( 18, CF_NO_CLIP2)
		F_set_chr( 19, CF_NO_CLIP2)
	}

	set_chr( 23,100,	 2, 5,   200,   0,  0,		  0,   270, 0,";")//⑧敵a いわつつき
	set_chr( 24,216,	 2, 5,  -200, 450,  0,		  0,   270, 0,";")//⑧敵b あーす
	set_chr( 25,216,	 2, 5,  -200, 900,  0,		  0,    90, 0,";")//⑧敵c あーす

//■イベント
//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
	// ⑦扉
	set_chr(150,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(M7?59 WT?10 M4_54  M6?59 WT?10 M5_54);")

	if ( !F2100 )
	{
		// 中ボス
		set_chr( 81,990,	 2, 3,   100,   0,  0,		  0,   106, 6,"SF100;")//⑦敵 中ボス部屋 戦闘開始エリアa
		set_chr( 82,990,	 1, 4,     0, 100,  0,		  0,   601, 6,"SF100;")//⑦敵 中ボス部屋 戦闘開始エリアb
		set_chr( 83,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F100 S0_1 WT?120 #6_84;")//警報出現
		set_chr( 84,990,	 2, 4,  -900,-900,  0,		  0,072323, 0,"SF101 M5_51 M5_52;")//中ボス出現
		set_chr( 85,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F10 F11 F12 F13 F14 F15 F16 F17 F18 F19 WT?10 SF2100 O1_18 <EV_NormalBGM> WT?30 #8_86;")//中ボス戦闘終了
		set_chr( 86,990,	 0, 0,     0,   0,  0,		  0,     0, 0,"C0_55 WT?20 M4_55 M4_51 M4_52 WT?30 C0_0;")
	
		// 中ボスBGM
		set_chr(160,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F103 <EV_BossBGM> WT?90 !F101 !F103 <EV_NormalBGM> WT?90);");
		set_chr(161,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"!F2100 F101 SF103");	// ボスが生きていて、ボス戦闘中ならば103をセット
		set_chr(162,990,	 2, 4,  -900,-900,  0,		  0,072323, 6,"!F2100 SF103");		// ボスが生きていて、ボス部屋内ならば103をセット
		set_chr(163,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"RF103");				// 103をクリア
	}
	else
	{
		MOT( 55, 6, 0 )
	}

	// リフトアニメ
	set_chr(156,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F106 M+_110 M+_111 M+_118 M+_119 M+_120 !F106 M-_110 M-_111 M-_118 M-_119 M-_120);")//リフトアニメ[路線A]
	set_chr(157,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F107 M+_112 M+_113 M+_121               !F107 M-_112 M-_113 M-_121);")//リフトアニメ[路線B]
	set_chr(158,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F108 M+_114 M+_115 M+_122               !F108 M-_114 M-_115 M-_122);")//リフトアニメ[路線C]
	set_chr(159,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F109 M+_116 M+_117 M+_123               !F109 M-_116 M-_117 M-_123);")//リフトアニメ[路線D]

//■場面固有設定
	map_color(100,100,100,0);//R,G,B, time 100%
	map_spotbmp(40);//100%
}

//--------------------------------------------------------------------
EV_BossBGM
{
	stop_BGM(30)
	wait(30)
	BGM(35)
}

//--------------------------------------------------------------------
EV_NormalBGM
{
	stop_BGM(30)
	wait(30)
	BGM(21)
}

//--------------------------------------------------------------------
EV_SlotDarken
{
	wait(15)
	color2( 49, 70,70,70,,0,0,0)		// スロット暗く
}

//--------------------------------------------------------------------
EV_SetGetBomb2
{
	F_set(Fx_123Bomb2)
}

//--------------------------------------------------------------------
EV_SetGetBomb3
{
	F_set(Fx_123Bomb3)
}

//--------------------------------------------------------------------
EV_BossItemSpawner
{
	set_chr(164,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F10 I_FFF3 I_FFF3 I_FFF3;");
	chr_equip_chr(164, 10,"Bone_Head", 100,	0,0,0,	0,0,0);
}

#EndScriptTable
//====================================================================

