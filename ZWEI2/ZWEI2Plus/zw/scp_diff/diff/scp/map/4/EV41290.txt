//====================================================================
//ステージトラップスクリプト
//[14029][大鉄塔－武器終]
//====================================================================

#ScriptTable

#TREASURE_CH	49
#IT_TREASURE	131		//Dパーツ

//--------------------------------------------------------------------
INIT
{
//環境SE
	SE(63,0)
	SE(65,0)

//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
//■階段・扉
	set_chr( 90,990,	 5, 6,     0, 200,  0,		180,  0201, 6,"K1_14023;")	//②エントリ 武器③
	set_obj("@ob40020a", 5, 6,     0, 200,  0,		180)						//①アーチ（塔）
	set_chr(190,1400,	 5, 6,     0, 200,  0,		  0,     0, 0,";")			//アーチ（ダミー）

//■スイッチ・看板
	set_chr( 50,620,	 5, 5,  -350,   0,  0,		  0,   270, 0,";")			//①セーブOBJ

//■宝箱

//■罠・障害物
	set_chr(120 627,	 5, 7,     0,-400,  0,		  0,     0, 0,";")	//柵小
	set_chr(121 627,	 4, 6,   400,   0,  0,		  0,   270, 0,";")	//柵小
	set_chr(122 627,	 6, 6,  -400,   0,  0,		  0,   270, 0,";")	//柵小
	color2(120, 100,85,85, 0,0,0)	// 塔の柵の色
	color2(121, 100,85,85, 0,0,0)	// 塔の柵の色
	color2(122, 100,85,85, 0,0,0)	// 塔の柵の色

	set_chr(123 627,	 3, 4,   400    0,  0,		  0,   270, 0,";")	//柵小
	set_chr(124 627,	 4, 5,     0,-400,  0,		  0,     0, 0,";")	//柵小
	set_chr(125 627,	 4, 3,     0, 400,  0,		  0,     0, 0,";")	//柵小
	color2(123, 100,85,85, 0,0,0)	// 塔の柵の色
	color2(124, 100,85,85, 0,0,0)	// 塔の柵の色
	color2(125, 100,85,85, 0,0,0)	// 塔の柵の色

	set_chr(110,623,	 5, 7,     0,-100,  0,		  2,     0, 0,"") //①ガスコンロ
	set_chr(111,623,	 4, 6,   100,   0,  0,		  2,     0, 0,"") //②ガスコンロ
	set_chr(112,623,	 6, 6,  -100,   0,  0,		  2,     0, 0,"") //③ガスコンロ

	set_chr(113,623,	 3, 4,   100,   0,  0,		  2,     0, 0,"") //④ガスコンロ
	set_chr(114,623,	 4, 5,     0,-100,  0,		  2,     0, 0,"") //⑤ガスコンロ
	set_chr(115,623,	 4, 3,     0, 100,  0,		  2,     0, 0,"") //⑥ガスコンロ

//■イベント
	//ＧＦ『★炎のパーツを入手した』立ってない
	if(!F2_10_GetFirePart)
		set_chr( 49,563,	-1,-1, 7650, 7650,  0,		  6,   270, 2,"<EV_2_11_GetFirePart>;")//宝箱
	else
		set_chr( 49,563,	-1,-1, 7650, 7650,  0,		  7,   270, 0,"")//宝箱


//■場面固有設定
}

//====================================================================
//=== イベント処理 ===================================================
//====================================================================
//──────────────────────────────
//▼武器ルートでパーツを手に入れる
//──────────────────────────────
//　　武器ルートの最奥で
//　　炎のパーツ（仮）を手に入れるとイベント発生。
//　　以下はクモボスを倒すため、すでに飛行場の親父（仮）に
//　　アンカーギアの強化を頼んでいるのが前提の文章になる。
EV_2_11_GetFirePart
{
	TK_begin()
	rot_chr(0,60,TREASURE_CH)

	//宝箱が開く
	MOT(TREASURE_CH,1,0)

	//宝演出
	BGM_vol(50,15)				//BGMフェード
	wait(20)
	fade_in(30,10,BLACK)		//少し暗転

	get_item(IT_TREASURE,1,0)	//パーツ入手テキスト
	wait(70)
	wait_key(0)
	BGM_vol(100,30)				//BGM戻し
	fade_in(0,10,BLACK)			//暗転解除
	menu(1,		-1,	-1,-1,-1,	-1,-1,	10,0,0)
	menu(0,		-1,	-1,-1,-1,	-1,-1,	10,0,0)

	TK_end()

	EV_begin()

	cross_fade(30)

	//キャラ再配置
	chr_pos(RAGNA,	7900,7650,0,90,2)
	chr_pos(PARTNER,8020,7770,0,100,2)

	//カメラ初期位置
	CAM_move(7860,-7678,180,0,0)
	CAM(390,100,180,25,225,0,0)

	wait(30)


	rot_chr(PARTNER,30,RAGNA)
	wait(15)

//★水ボス手前でフックギア入手が必須となるので以下の分岐は必要ナシ（竹）
//宝箱からパーツを入手したのが初めての場合
//	if(!FE_FF_GetPart)
//	{
//		MES(PARTNER,"これは……？",0)
//		MES(PARTNER,"かなり古い品のようだが……\n何やら炎の力を秘めておるな。",0)
//		MES_close(PARTNER)
//		
//		rot_chr(RAGNA,60,PARTNER)
//		wait(15)
//
//	//	name2(RAGNA)
//		MES(RAGNA,"そ、そうなのか？",0)
//		MES(RAGNA,"うーん、大分さび付いちまってるし\nちょっと見たことのないパーツだが……",0)
//		MES(RAGNA,"（炎の力……か。\n  何かに使えねえかな……）",0)
//		MES_close(RAGNA)
//
//		//★改造パーツを入手した▼初回
//		F_set(FE_FF_GetPart)
//		
//	}
//	else
//	{
//	//	name2(PARTNER)
//		MES(PARTNER,"ほう……\nまた古代の機械部品か。",0)
//		MES(PARTNER,"どうやら炎の力を\n秘めているようだな。",0)
//		MES_close(PARTNER)
//
//		rot_chr(RAGNA,30,PARTNER)
//		wait(15)
//	//	name2(RAGNA)
//		MES(RAGNA,"ああ……\nコイツは使えそうだぜ。",0)
//		MES(RAGNA,"アンカーギアに組み込めないか\n飛行場の親父に相談してみるか。",0)
//		MES_close(RAGNA)
//	}

	MES(PARTNER,"ほう……\nまた古代の機械部品か。",0)
	MES(PARTNER,"どうやら炎の力を\n秘めているようだな。",0)
	MES_close(PARTNER)

	rot_chr(RAGNA,30,PARTNER)
	wait(15)
	MES(RAGNA,"ああ……\nコイツは使えそうだぜ。",0)
//	MES(RAGNA,"アンカーギアに組み込めないか\n飛行場の親父に相談してみるか。",0)
	MES(RAGNA,"アンカーギアに組み込めないか\n工房の親方に相談してみるか。",0)
	MES_close(RAGNA)


//	MES(RAGNA,"◆未入力項目\n工房でアンカーギアがパワーアップ。\n茨の結界が破壊可能になる。",0)
//	MES_close(RAGNA)

//　　イベント終了、プレイヤー操作許可。
//　　以後、飛行場の工房に行って親方（仮）に話しかけると
//　　アンカーギアに炎のパーツを組み込むイベントが発生する。
	fade_in(100,30,0)
	wait_fade()

	CAM_return(0)
	wait(30)

//ＧＦ『★炎のパーツを入手した』を立てる。
	F_set(F2_10_GetFirePart)

	fade_in(0,30,0)

	EV_end()
}


#EndScriptTable
//====================================================================

