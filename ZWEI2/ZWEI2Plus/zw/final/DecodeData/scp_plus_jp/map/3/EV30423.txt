//====================================================================
//ステージトラップスクリプト
//[13042][森－サブ②]
//====================================================================

#ScriptTable

//--------------------------------------------------------------------
//■グローバルフラグ・ルートフラグはev30413.txt参照

//■ローカルフラグ
// 109 レバースイッチ①を押した
// 101 中ボス警報
// 102 中ボス出現
// 103 中ボスBGM管理
// 104 こぼるたん出現 こぼるときんぐのモーション定義ファイル内でセット
// 105 虫の部屋の扉を開けた（初回)

#TREASURE_CH	49
#Fx_TREASURE	2304	//☆004金のなる木

#WOODBOX_CH		48
#IT_WOODBOX		218		//218ペットフード
#NUM_WOODBOX	2

//--------------------------------------------------------------------
INIT
{
//環境SE
	SE(61,0)//鳥1
	SE(72,0)//鳥2

//■地形
	set_obj("obx0494",	 4, 8,	 0,   0,  0,  	 0);		// 沼

//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
//■階段・扉
	set_chr( 90,990,	 8,10,     0,   0,  0,		 90,  0102, 6,"K0_1;")		//①エントリ サブ①
	set_obj("@obx0013a", 8,10,     0,   0,  0,		 90)						//①階段入（森緑）
	set_chr(190,1300,	 8,10,	   0,   0,  0,		  0,    90, 0,";")			//階段下（ダミー）

	set_chr( 91,990,	 4, 4,     0,   0,  0,		  0,  0201, 6,"K0_0;")		//②エントリ サブ③
	set_obj("@obx0023a", 4, 4,     0,   0,  0,		  0)						//②階段出（森緑）
	set_chr(191,1301,	 4, 4,	   0,   0,  0,		  0,     0, 0,";")			//階段上（ダミー）

	set_chr( 50,501,	 4, 6,   900,   0,  0,		  3,   270, 6,";")	//③扉（森） 自由

	set_chr( 51,501,	 4, 7,   900,   0,  0,		  3,   270, 6,";")	//④扉（森） 自由
	set_chr( 52,501,	 4, 8,   900,   0,  0,		  3,   270, 6,";")	//⑤扉（森） 自由
	set_chr( 53,501,	 6, 6,  -900,   0,  0,		  7,   270, 0,";")	//⑥扉（森） 閉鎖
	set_chr( 55,501,	 6, 7,  -900,   0,  0,		  3,    90, 6,";")	//⑧扉（森） 自由
	set_chr( 56,501,	 6, 8,  -900,   0,  0,		  3,    90, 6,";")	//⑨扉（森） 自由
	set_chr( 57,501,	 5, 8,     0, 900,  0,		  3,   180, 6,";")	//⑩扉（森） 自由
	set_chr( 58,501,	 5, 3,     0, 900,  0,		  7,   180, 0,";")	//⑪扉（森） 閉鎖
	set_chr( 59,501,	 5, 5,     0, 900,  0,		  6,   180, 0,";")	//⑫扉（森） 開放
	set_chr( 60,501,	 7, 8,  -750,   0,  0,		  7,   270, 0,";")	//⑬扉（森） 閉鎖
	set_chr( 61,501,	 4, 4,   900,   0,  0,		  7,    90, 0,";")	//⑭扉（森） 閉鎖

//■スイッチ・看板

	if ( !F2101 )
	{
	// 初回
		set_chr( 63,570,	 6, 7,  -300,-300,  0,		  6,     0, 5,"M6?99 M5_99 SF2101;")	//①ボタンスイッチ
		set_chr(180,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F2101 O1_18 WT?10 C0_53 WT?20 M4_53 WT?30 C0_0;")//①ボタンスイッチ押下
	}
	else
	{
	// 押され
		set_chr( 63,570,	 6, 7,  -300,-300,  0,		  7,     0, 3,";")	//①ボタンスイッチ
		set_chr(180,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"M6_53;")//①ボタンスイッチ押下
	}

	set_chr( 64,804,	 4, 4,   300,   0,  0,		  0,   345, 8,"(L2?99 [9991またお越しください！\nこぼるときんぐだむ観光組合] WT?30 L2!99 [9903] WT?30);")	//③看板
	set_chr( 65,804,	 7,10,   450,-350,  0,		  0,     0, 8,"(L2?99 [9991いらっしゃいませ！\nこぼるときんぐだむ観光組合] WT?30 L2!99 [9903] WT?30);")	//④看板
	set_chr( 66,804,	 4, 8,  -350,   0,  0,		  0,   270, 8,"(L2?99 [9991ノミ取り\n泥エステ] WT?30 L2!99 [9903] WT?30);")	//⑤看板
	set_chr( 67,804,	 6, 8,   300,-300,  0,		  0,    25, 8,"(L2?99 [9991スイーツ\nこんちゅうゼリー] WT?30 L2!99 [9903] WT?30);")	//⑧看板
	set_chr( 68,571,	 6, 8,   600,-400,  0,		  6,     0, 5,"M!_99")	//⑦レバースイッチ
	set_chr( 69,655,	 4, 6,  -350,   0,  0,		  2,   270, 0,";")	//⑥順路案内
	set_chr( 70,804,	 4, 7,   350,-200,  0,		  0,   270, 8,"(L2?99 [9991遠赤焙煎\n岩盤浴] WT?30 L2!99 [9903] WT?30);")	//⑨看板
	set_chr( 71,658,	 5, 6,   350,-425,  0,		  0,     0, 0,";")	//⑩中ボス看板

//■ハニワ・壷

	if ( !F2160 )
	{
		set_chr( 40,802,	 5, 9,  -300, 300,  0,		  2,     0, 0,"I_$$$1 SF2160 V4_140;")	//①壷
		set_chr(140,811,	 5, 9,  -300, 300,  0,		 -1,     0, 0,";")
	}
	else
	{
		set_chr(140,811,	 5, 9,  -300, 300,  0,		  0,     0, 0,";")
	}


	if ( !F2161 )
	{
		set_chr( 41,802,	 4, 8,   325, 325,  0,		  2,     0, 0,"I_$$$1 SF2161 V4_141;")	//②壷
		set_chr(141,811,	 4, 8,   325, 325,  0,		 -1,     0, 0,";")
	}
	else
	{
		set_chr(141,811,	 4, 8,   325, 325,  0,		  0,     0, 0,";")
	}


	if ( !F2162 )
	{
		set_chr( 42,802,	 6, 8,   825, 475,  0,		  2,    60, 0,"I_$$$1 SF2162 V4_142;")	//③壷
		set_chr(142,811,	 6, 8,   825, 475,  0,		 -1,    60, 0,";")
	}
	else
	{
		set_chr(142,811,	 6, 8,   825, 475,  0,		  0,    60, 0,";")
	}


	if ( !F2163 )
	{
		set_chr( 43,802,	 4, 7,    75,-275,  0,		  2,   120, 0,"I_$$$1 SF2163 V4_143;")	//④壷
		set_chr(143,811,	 4, 7,    75,-275,  0,		 -1,   120, 0,";")
	}
	else
	{
		set_chr(143,811,	 4, 7,    75,-275,  0,		  0,   120, 0,";")
	}


	if ( !F2164 )
	{
		set_chr( 44,802,	 6, 6,  -400,-250,  0,		  2,   180, 0,"I_$$$1 SF2164 V4_144;")	//⑤壷
		set_chr(144,811,	 6, 6,  -400,-250,  0,		 -1,   180, 0,";")
	}
	else
	{
		set_chr(144,811,	 6, 6,  -400,-250,  0,		  0,   180, 0,";")
	}


	if ( !F2165 )
	{
		set_chr( 45,802,	 4, 4,   550,-200,  0,		  2,   220, 0,"I_$$$1 SF2165 V4_145;")	//⑥壷
		set_chr(145,811,	 4, 4,   550,-200,  0,		 -1,   220, 0,";")
	}
	else
	{
		set_chr(145,811,	 4, 4,   550,-200,  0,		  0,     0, 0,";")
	}


//■宝箱
	if( !Fx_TREASURE )
		set_chr( TREASURE_CH,561,	 5, 3,     0,   0,  0,		 6,     0,20,"<TK_TREASURE>;")
	else
		set_chr( TREASURE_CH,561,	 5, 3,     0,   0,  0,		 7,     0, 0,";")


	if ( !Fx_342PetFood1 )
		set_chr( WOODBOX_CH,562,	 7, 8,   350, 350,  0,		 6,    90,20,"<TK_WOODBOX_X><EV_SetGetPetFood1>;")	//②木箱
	else
		set_chr( WOODBOX_CH,562,	 7, 8,   350, 350,  0,		 7,    90, 0,";")	//②木箱


//■罠・障害物

	if ( !F2120 )
		set_chr( 75,630,	 6, 6,     0,   0,  0,		  2,   135, 0,"I_FFF1 SF2120;")	//①樽
	else
		set_chr( 75,630,	 6, 6,     0,   0,  0,		  2,   135, 0,"I_$$$1;")	//①樽


	if ( !F2121 )
		set_chr( 76,630,	 4, 9,     0,   0,  0,		  2,   270, 0,"I_FFF1 SF2121;")	//②樽
	else
		set_chr( 76,630,	 4, 9,     0,   0,  0,		  2,   270, 0,"I_$$$1;")	//②樽


	set_chr( 77,623,	 4, 7,     0,   0,  0,		 	  2,     0, 0,";") //③ガスコンロ

	if ( !F2185 )
	{
		set_chr( 78,642,	 4, 7,     0,   0,  0,		  2,     0, 0,"I_BBB1 I_BBB1 I_$$$1 SF2185;")	//③岩
	}
	set_chr( 79,656,	 4, 6,   925, 275, 15,		  2,   265, 0,";")	//④信号
		set_chr(179,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(M4_79 M4_50 WT?90 M3_79 WT?45 M2_79 M5_50 WT?90);")//信号

	set_chr(110,627,	 7, 8,  -750, 400,  0,		  0,   270, 0,";")	//通路用汎用柵a
	set_chr(111,627,	 7, 8,  -750,-400,  0,		  0,   270, 0,";")	//通路用汎用柵b

//■敵
	set_chr(  2,312,	 7, 8,   250, 150,  0,		  2,   110, 0,";")//⑮敵a みどじぇりー
	set_chr(  3,312,	 7, 8,     0,-150,  0,		  2,    90, 0,";")//⑮敵b みどじぇりー
	set_chr(  4,312,	 7, 8,     0, 150,  0,		  2,    70, 0,";")//⑮敵c みどじぇりー
	set_chr(  5,150,	 7, 8,   250,-150,  0,		  2,    90, 0,";")//⑯敵a あるけにー

	// 広場
	set_chr(  6,255,	 5, 6,     0,   0,  0,		  2,    45, 0,";")//②敵 もりこぼると
		chr_equip2(  6,	"eq_057",	"Bone_Head", 100,		0,0,0,	0,0,0);		// シルクハット

	set_chr(  7,255,	 5, 7,     0,   0,  0,		  2,   315, 0,";")//③敵 もりこぼると
		chr_equip2( 7,	"eq_006",	"Bone_RightArm",100,    30,-60,0,		0,25,0);	// 両刃斧
		chr_equip2( 7,	"eq_101",	"Bone_LeftHand",100,    75, 45,0,		0, 0,-15);	// 盾（前）
		chr_state_LV(  7, 1);

	// エステ
	set_chr(  9,255,	 4, 8,   200,   0,  0,		  2,   270, 0,";")//④敵 もりこぼると

	// 厨房?
	set_chr( 11,255,	 6, 7,     0,   0,  0,		  2,    90, 0,";")//⑥敵 もりこぼると
		chr_equip2( 11,	"eq_010",	"Bone_RightArm",100,    0, 90,0,		0,25,0);	// フライパン

	// 広場
	set_chr( 12,227,	 5, 8,  -250, 300,  0,		  2,     0, 0,";")//⑦敵a こぼるとないと
	set_chr( 13,255,	 5, 8,   250, 300,  0,		  2,     0, 0,";")//⑦敵b もりこぼると

	// 入口ホール
	set_chr( 14,255,	 6, 9,  -900, 200,  0,		  2,   270, 0,";")//⑧敵a もりこぼると
		chr_equip2( 14,	"eq_008",	"Bone_RightArm",100,    0,45,0,		0,25,0);	// ハリセン

	set_chr( 15,255,	 6, 9,  -600,-200,  0,		  2,   270, 0,";")//⑧敵b もりこぼると

	// 出口通路前
	set_chr( 16,255,	 4, 6,  -200,-200,  0,		  2,   270, 0,";")//⑨敵 もりこぼると
		chr_equip2( 16,	"eq_057",	"Bone_Head", 100,		0,0,0,	0,0,0);		// シルクハット

	// 入口付近
	set_chr( 17,255,	 7, 9,   125,-125,  0,		 -2,   290, 0,";")//⑩敵 もりこぼると

	// 王の部屋の前
	set_chr( 19,227,	 5, 6,  -200,-500,  0,		  0,     0, 0,";") //⑫敵a こぼるとないと
	set_chr( 18,227,	 5, 6,   200,-200,  0,		  0,     0, 0,";") //⑫敵b こぼるとないと


	if ( !F2100 )
	{
		set_chr( 20,353,	 5, 4,     0, 450,  0,		 -1,     0, 8,"F101 WT?95 V3_99 <EV_BossItemSpawner>;")//⑪敵 こぼるときんぐ
			F_set_chr( 20, CF_NO_CLIP2)

		set_chr( 21,104,	 5, 4,     0,-450,  0,		 -1,     0, 8,"F101 WT?35 V3_99 <EV_GenMonsterRider>;")//⑪敵b あばどん
			F_set_chr( 21, CF_NO_CLIP2)
			// 22は乗り手用予約

		set_chr( 25,227,	 5, 5,  -200,-600,  0,		 -1,     0, 8,"F101 WT?5 V3_99;") //⑪敵f こぼるとないと
			F_set_chr( 25, CF_NO_CLIP2)

		set_chr( 26,227,	 5, 5,   200,-600,  0,		 -1,     0, 8,"F101 WT?5 V3_99;") //⑪敵f こぼるとないと
			F_set_chr( 26, CF_NO_CLIP2)

		set_chr( 27,228,	 5, 4,     0, 200,400,		 -1,     0, 8,"F104 V2_99;") //⑪敵g こぼるたん
			F_set_chr( 27, CF_NO_CLIP2)


		set_chr( 80,990,	 5, 5,     0,-900,  0,		  0,071024, 6,"SF100;")//①敵 中ボス部屋 登場エリア
		set_chr( 81,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F100 S0_1 WT?120 #6_82;")//警報出現
		set_chr( 82,990,	 5, 5,     0,-900,  0,		  0,071029, 0,"SF101 M5_59 #8_83;")//中ボス出現
		set_chr( 83,990,	 0, 0,     0,   0,  0,		  0,     0, 0,"F20 WT?10 O1_18 SF2100 <EV_NormalBGM> WT?30 #8_84;")//中ボス戦闘終了判定
		set_chr( 84,990,	 0, 0,     0,   0,  0,		  0,     0, 0,"C0_58 WT?20 M4_61 M4_59 M4_58 WT?30 C0_0;")
		
		// 中ボスBGM
		set_chr(160,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F103 <EV_BossBGM> WT?90 !F101 !F103 <EV_NormalBGM> WT?90);");
		set_chr(161,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"!F2100 F101 SF103");	// ボスが生きていて、ボス戦闘中ならば103をセット
		set_chr(162,990,	 5, 5,     0,-900,  0,		  0,071029, 6,"!F2100 SF103");		// ボスが生きていて、ボス部屋内ならば103をセット
		set_chr(163,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"RF103");				// 103をクリア
	}
	else
	{
		MOT( 58, 6, 1)
		MOT( 61, 6, 1)
	}

//■イベント
	set_chr(184,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(M7?68 SF105 M4_60 WT?5 M6?68 WT?5 M5_60);")//⑦スイッチ切り替え
	set_chr(185,990,	 7, 8,     0,   0,  0,		  0,  0510, 6,"M7?68 M4_68")//虫の部屋のトラップ

	if ( !F2104 )
	{
		set_chr(186,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F105 O1_18 SF2104;")
	}

//■場面固有設定
}

//--------------------------------------------------------------------
EV_SetGetPetFood1
{
	F_set(Fx_342PetFood1)
}

//--------------------------------------------------------------------
EV_BossItemSpawner
{
	set_chr(164,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F20 I_FFF3 I_FFF3 I_FFF3;");
	chr_equip_chr(164, 20,"Bone_Spine", 100,	0,0,0,	0,0,0);
}

/--------------------------------------------------------------------
EV_BossBGM
{
	stop_BGM(30)
	wait(30)
	BGM(35)
}

//--------------------------------------------------------------------
EV_NormalBGM
{
	stop_BGM(30)
	wait(30)
	BGM(23)
}

//--------------------------------------------------------------------
EV_GenMonsterRider
{
	set_chr( 22,227, 5, 5,     0,-900,  0,		      2,     0, 0,";") //⑪敵b こぼるとないと
		chr_equip_chr(22,21,"Bone_Spine04", 100,	0, 0, 180,	0, -35, 35);
		F_set_chr( 22, CF_NO_CLIP2)
}

#EndScriptTable
//====================================================================

