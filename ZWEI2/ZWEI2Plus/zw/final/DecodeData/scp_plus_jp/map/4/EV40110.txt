//====================================================================
//ステージトラップスクリプト
//[14011][大鉄塔－メイン①]
//====================================================================

#ScriptTable

//--------------------------------------------------------------------
//■グローバルフラグ
// 2944		フードスロット

//■ルートフラグ 2096-2192

// 2100 メイン① 中ボス死亡
// 2112 メイン② 的をすべてヒットさせて扉を開けた1
// 2113 メイン② 的をすべてヒットさせて扉を開けた2
// 2115 メイン② ⑤ボタンスイッチを押した

// 2116 メイン③ ①ボタンスイッチ押下
// 2117 メイン③ ②ボタンスイッチ押下
// 2118 メイン③ ③ボタンスイッチ押下

// 2130 メイン② ④樽
// 2131 メイン② ⑦樽
// 2132 メイン② ⑧樽

// 2140 メイン③ ⑨顔の置物
// 2141 メイン③ ⑩顔の置物

// 2150 メイン① ①壷
// 2151 メイン① ②壷
// 2152 メイン① ③壷
// 2153 メイン① ④ハニワ

// 2160 メイン② ①壷
// 2161 メイン② ②壷
// 2162 メイン② ③壷
// 2163 メイン② ④壷

// 2170 メイン③ ①壷
// 2171 メイン③ ②壷
// 2172 メイン③ ③ハニワ
// 2173 メイン③ ④ハニワ
// 2174 メイン③ ④壷

// 2185 メイン② ⑤爆弾タル
// 2185 メイン② ⑥爆弾タル

// 2190 メイン③ ④大砲
// 2191 メイン③ ⑤大砲
// 2192 メイン③ ⑥大砲
// 2193 メイン③ ⑦大砲


//■ローカルフラグ
// 100 ①空台車発車
// 101 中ボス警告
// 102 中ボス登場
// 103 中ボスBGM管理
// 104 イベント終了待ちワーク
// 109 路線Aアニメon/off

#TAKARA_CH	49
#IT_TAKARA	114		//◇114メールＢＯＸ

#WOODBOX_CH		48
#IT_WOODBOX		173		//∴173ピザ

//--------------------------------------------------------------------
INIT
{
//環境SE
	SE(63,0)
	SE(65,0)

//■地形
	F_set_chr(PLAYER1, CF_NO_FALL )
	F_set_chr(PLAYER2, CF_NO_FALL )
	F_set_chr(PET, CF_NO_FALL )

	set_obj2("obx001k",	 3, 3,     0, 900,  0,	  180) //鉄塔縁↓
	set_obj2("obx001k",	 5, 3,     0, 900,  0,	  180) //鉄塔縁↓

	set_obj("mp40160",	 3, 4,  -450,   0,  0,	 0) //歯車
	set_obj("mp40160",	 5, 4,  -450,   0,  0,	 0) //歯車


	set_obj("mp40160",	 4, 5,  -750, 600,  0,	 0) //歯車
	set_obj2("obx001k",	 5, 5,  -900,   0,  0,   270) //

	set_obj("mp40160",	 2, 7,   450,-450,  0,	 0) //歯車

	set_obj2("obx001k",	 3, 7,     0,-900,  0,     0) //

	set_chr(180,991,	 5, 5,     0,-600,  0,	 0,071901, 0,";")	// 空気壁
	set_chr(181,991,	 6, 4,  -900, 200,  0,	 0,070119, 0,";")	// 空気壁

//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
//■階段・扉
	set_chr( 90,990,	 7, 7,     0, 225,  0,		180,  0201, 6,"K0_1;")		//①エントリ 入口分岐
	set_obj("@ob40020a", 7, 7,     0, 225,  0,		180)						//①アーチ（塔）
	set_chr(190,1400,	 7, 7,     0, 225,  0,		  0,   180, 0,";")			//アーチ（ダミー）

	set_chr( 91,990,	 6, 7,     0,   0,  0,		 90,  0102, 6,"K0_0;")		//②エントリ メイン②
	set_obj("@ob40000a", 6, 7,     0,   0,  0,		 90)						//②階段上（塔）
	set_chr(191,1301,	 6, 7,	   0,   0,  0,		  0,    90, 0,";")			//階段上（ダミー）

	// チェックポイント
	set_chr( 95,990,	 5, 3,     0, 900,  0,		180,070602, 6,"k5_0")
	set_chr( 96,990,	 3, 3,     0, 900,  0,		180,070602, 6,"k6_0")
	set_chr( 97,990,	 3, 7,     0,-900,  0,		  0,070602, 6,"k7_0")
	set_chr( 98,990,	 5, 5,  -900,   0,  0,		270,070206, 6,"k8_0")

	set_chr( 50,500,	 7, 5,     0,-900,  0,		  3,   180, 6,";")	//③扉（塔）自由
	set_chr( 51,500,	 7, 3,  -900,   0,  0,		  3,    90, 6,";")	//④扉（塔）自由
	set_chr( 52,500,	 5, 6,  -450,   0,  0,		  6,   270, 0,";")	//⑤扉（塔）開放
	set_chr( 53,500,	 6, 5,     0,-450,  0,		  7,   180, 0,";")	//⑥扉（塔）閉鎖

//■スイッチ・看板
	set_chr( 57,658,	 4, 6,   300,-100,  0,		  0,     0, 0,";")	//②看板
	set_chr( 58,658,	 4, 5,   650,-120,100,		  0,     0, 0,";")	//②看板
	set_chr( 55,571,	 3, 3,  -250, 350,  0,		  6,   270, 5,"M!_99 M!_56 SF100")	//③レバースイッチ
	set_chr( 56,571,	 3, 7,  -250,-350,  0,		  6,   270, 5,"M!_99 M!_55 SF100")	//④レバースイッチ
	set_chr( 59,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F100 O1_18;")

//■ハニワ・壷

	if ( !F2150 )
	{
		set_chr( 40,802,	 7, 3,   375,-375,  0,		  2,    90, 0,"V1_8 I_$$$1 SF2150 V4_140;")	//①壷
		set_chr(140,811,	 7, 3,   375,-375,  0,		 -1,    90, 0,";")
	}
	else
	{
		set_chr(140,811,	 7, 3,   375,-375,  0,		  0,    90, 0,"V1_8;")
	}


	if ( !F2151 )
	{
		set_chr( 41,802,	 3, 4,   750, 900,150,		  2,   135, 0,"I_$$$1 SF2151 V4_141;")	//②壷
		set_chr(141,811,	 3, 4,   750, 900,150,		 -1,   135, 0,";")
	}
	else
	{
		set_chr(140,811,	 3, 4,   750, 900,150,		  0,   135, 0,";")
	}


	if ( !F2152 )
	{
		set_chr( 42,802,	 4, 6,   900,   0,  0,		  2,   180, 0,"I_$$$1 SF2152 V4_142;")	//③壷
		set_chr(142,811,	 4, 6,   900,   0,  0,		 -1,   180, 0,";")
	}
	else
	{
		set_chr(142,811,	 4, 6,   900,   0,  0,		  0,   180, 0,";")
	}


	if ( !F2153 )
	{
		set_chr( 43,634,	 3, 7,   106,  84,345,		  2,   245, 0,"I_US01 SF2153 V4_143;")	//④ハニワ
		set_chr(143,812,	 3, 7,   106,  84,345,		 -1,   245, 0,";")
	}
	else
	{
		set_chr(143,812,	 3, 7,   106,  84,345,		  0,   245, 0,";")
	}


//■宝箱

	if(IT_TAKARA<0)
	{
		set_chr( TAKARA_CH,560,	   6, 4,     0,   0,  0,  	   6,     0,20,"<TK_TAKARA>;")		//②宝箱（並）
	}
	else
	{
		set_chr( TAKARA_CH,560,    6, 4,     0,   0,  0,  	   7,     0, 0,";")		//②宝箱（並）
	}


	if ( !Fx_411Food1 )
	{
		set_chr( WOODBOX_CH,562,	3, 5,  -475, 900, 40,		  6,   270,20,"<TK_WOODBOX><EV_SetGetFood1> #8_148;")	//①木箱
		set_chr( 148,990,	0, 0,    0,0,0,  	 0,     0, 3,"#3_60 <EV_Wait104> F104 #8_60;")
	}
	else
		set_chr( WOODBOX_CH,562,	3, 5,  -475, 900, 40,		  7,   270, 0,";")	//①木箱


//■罠・障害物
	if(WK_ENTRY==91)//階段91 から来た時（帰り）
	{
		set_chr( 60,703, 3, 7,     0,-300,  0,		  2,     0, 8,"F100 M3_99 M3_110 M3_111 M3_112 M3_113 M3_114 M3_115 WT?15 (SF109 Y2_6600 RF109 M4_99 WT?30 SF109 Y2_-6600 RF109 M3_99 WT?30);")//①長リフト台[路線A]
	}
	else 
	{
		set_chr( 60,703, 3, 3,     0, 300,  0,		  5,     0, 8,"F100 M4_99 M3_110 M3_111 M3_112 M3_113 M3_114 M3_115 WT?15 (SF109 Y2_-6600 RF109 M3_99 WT?30 SF109 Y2_6600 RF109 M4_99 WT?30);")//①長リフト台[路線A]
	}

	set_chr( 61,660,	 5, 4,     0,-900,  0,		  2,     0, 8,"WT?30 M4?99 SF110 Z1_50 Y3_-1800 X3_-1650 Y3_-900;")	//②プロペラ移動床
	set_chr( 64,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F110 O1_18;")

	set_chr( 62,660,	 3, 5,  -735, 900, 50,		  3,     0, 0," ;")	//③プロペラ移動床
	set_chr( 63,660,	 3, 4,   750, 900, 50,		  3,     0, 0," ;")	//④プロペラ移動床

	set_chr(110,673,	 3, 3,     0,-150,  0,		  2,     0, 0,";")//リフト端[路線A]
	set_chr(111,673,	 3, 7,     0, 150,  0,		  2,   180, 0,";")//リフト端[路線A]
	set_chr(112,653,	 3, 4,     0,-900,  0,		  2,     0, 0,";")//リフト用ロープa[路線A]
	set_chr(113,653,	 3, 5,     0,-900,  0,		  2,     0, 0,";")//リフト用ロープb[路線A]
	set_chr(114,653,	 3, 6,     0,-900,  0,		  2,     0, 0,";")//リフト用ロープc[路線A]
	set_chr(115,653,	 3, 7,     0,-900,  0,		  2,     0, 0,";")//リフト用ロープd[路線A]

	set_chr(120,659,	 3, 4,   375, 900,-50,		  2,     0, 0,";")//③移動床大（火）
	set_chr(121,659,	 3, 5,  -360, 900,-60,		  2,     0, 0,";")//④移動床大（火）
	set_chr(123,659,	 4, 5,   500,   0,  0,		  2,     0, 0,";")//⑤移動床大（火）


//■敵
	if ( !F2100 )
	{
		// chr11-17はボスが生むために予約

		// 前座スライム
		set_chr( 20,316,	 5, 5,   900, 900,500,		 -1,     0, 8,"F101 V1_99;")//①敵 あかじぇりー
		set_chr( 21,316,	 5, 5,   900, 900,500,		 -1,     0, 8,"F101 V1_99;")//①敵 あかじぇりー
		set_chr( 22,316,	 5, 5,   900, 900,500,		 -1,     0, 8,"F101 V1_99;")//①敵 あかじぇりー
		set_chr( 23,316,	 5, 5,   900, 900,500,		 -1,     0, 8,"F101 V1_99;")//①敵 あかじぇりー
		set_chr( 24,316,	 5, 5,   900, 900,500,		 -1,     0, 8,"F101 V1_99;")//①敵 あかじぇりー
		set_chr( 25,316,	 5, 5,   900, 900,500,		 -1,     0, 8,"F101 V1_99;")//①敵 あかじぇりー
		set_chr( 26,316,	 5, 5,   900, 900,500,		 -1,     0, 8,"F101 V1_99;")//①敵 あかじぇりー
		// ボス
		set_chr( 19,361,	 5, 5,   900, 900,800,		 -1,     0, 8,"F102 V1_99 <EV_BossItemSpawner>;")//①敵 おおあかじぇりー

		set_chr( 81,990,	 5, 5,  -150,   0,  0,		  0,   105, 6,"SF101;")//中ボス部屋エリア
		set_chr( 82,990,	 5, 6,  -150,   0,  0,		  0,   105, 6,"SF101;")//中ボス部屋エリア
		set_chr( 83,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F101 S0_1 WT?120 #6_84;")//警報出現
		// 前座全滅か時間経過であかじぇりー大登場
		set_chr( 84,990,	 5, 5,   900, 900,  0,		  0,  2323, 0,"M5_52 SF102;")//ボス部屋閉鎖
		set_chr( 85,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F20 F21 F22 F23 F24 F25 F26 SF102;")//おおあかじぇりー登場
		set_chr( 86,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F19 F11 F12 F13 F14 F15 F16 F17 WT?10 O1_18 SF2100 <EV_NormalBGM> WT?30 C0_53 WT?20 M4_53 M4_52 WT?30 C0_0;")//中ボス戦闘終了判定

		// 中ボスBGM
		set_chr(160,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F103 <EV_BossBGM> WT?90 !F101 !F103 <EV_NormalBGM> WT?90);");
		set_chr(161,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"!F2100 F101 SF103");	// ボスが生きていて、ボス戦闘中ならば103をセット
		set_chr(162,990,	 5, 5,   900, 900,  0,		  0,  2323, 6,"!F2100 SF103");		// ボスが生きていて、ボス部屋内ならば103をセット
		set_chr(163,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"RF103");				// 103をクリア
	}
	else
	{
		set_chr( 86,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"M6_53;")
	}

	set_chr(  1,316,	 7, 5,  -200,  50,  0,		  2,     0, 0,";")//②敵a あかじぇりー
	set_chr(  2,316,	 7, 5,   200,  50,  0,		  2,     0, 0,";")//②敵b あかじぇりー
	set_chr(  3,226,	 7, 5,     0,-250,  0,		  2,     0, 0,";")//②敵c ふぁいやこぼると

	set_chr(  6,147,	 7, 4,     0, 250,  0,		  2,     0, 0,";")//③敵a あーけろん
	set_chr(  7,316,	 7, 3,  -150,   0,  0,		  2,     0, 0,";")//③敵b あかじぇりー

	set_chr(  8,316,	 7, 3,   375,-375,  0,		 -1,    45, 0,";")//⑤敵 あかじぇりー

	set_chr( 10,147,	 5, 3,   250,   0,  0,		  2,   270, 0,";")//④敵a あーけろん
	set_chr( 11,226,	 5, 3,  -450,-250,  0,		  2,   270, 0,";")//④敵b ふぁいやこぼると

	set_chr( 13,147,	 4, 7,     0,  50,  0,		  2,   135, 0,";")//⑥敵 あーけろん
	set_chr( 14,226,	 3, 7,     0, 250,  0,		  2,   180, 0,";")//⑦敵 ふぁいやこぼると

//■イベント

	set_chr( 88,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F109 M+_110 M+_111 M+_112 M+_113 M+_114 M+_115 !F109 M-_110 M-_111 M-_112 M-_113 M-_114 M-_115);")//リフトアニメ[路線A]
	set_chr(152,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"( M7?55 WT?10 #8_60 SF109  M6?55 WT?10 #0_60 RF109 );")//③レバースイッチ

//■場面固有設定
}

//--------------------------------------------------------------------
EV_Wait104
{
	wait_EV("TK_WOODBOX")
	F_set(104)
}

//--------------------------------------------------------------------
EV_SetGetFood1
{
	F_set(Fx_411Food1)
}

//--------------------------------------------------------------------
EV_BossItemSpawner
{
	set_chr(164,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F19 I_FFF3 I_FFF3 I_FFF3;");
	chr_equip_chr(164, 19,"csp", 100,	0,0,0,	0,0,0);
}

//--------------------------------------------------------------------
EV_BossBGM
{
	stop_BGM(30)
	wait(30)
	BGM(35)
}

//--------------------------------------------------------------------
EV_NormalBGM
{
	stop_BGM(30)
	wait(30)
	BGM(24)
}

#EndScriptTable
//====================================================================

