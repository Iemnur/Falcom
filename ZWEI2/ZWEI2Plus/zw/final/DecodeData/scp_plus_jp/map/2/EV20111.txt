//====================================================================
//ステージトラップスクリプト
//[12011][水没神殿－メイン①]
//====================================================================

#ScriptTable

//--------------------------------------------------------------------
//■グローバルフラグ
// 2924		フードスロット
// Fx_212Food1 メイン② 飯

//■ルートフラグ 2096-2192
// 2100 メイン③ 中ボス死亡
// 2101 メイン① ①ボタンスイッチを押した
// 2102 メイン① ②ボタンスイッチを押した
// 2103 メイン① 女神像を正しい位置に配置した

// 2104 メイン② ①ボタンスイッチを押した
// 2105 メイン② ②ボタンスイッチを押した
// 2106 メイン② ③ボタンスイッチを押した
// 2107 メイン② ④ボタンスイッチを押した
// 2108 メイン② ④扉が開いた
// 2109 メイン② ⑤扉⑥扉が開いた

// 2120 メイン① ①樽

// 2150 メイン① ①ハニワ
// 2151 メイン① ②壷
// 2152 メイン① ③壷
// 2153 メイン① ④壷 女神のくれる壷

// 2160 メイン② ①壷
// 2161 メイン② ②壷
// 2162 メイン② ③ハニワ
// 2163 メイン② ④壷
// 2164 メイン② ⑤壷
// 2165 メイン② ⑥壷

// 2170 メイン③ ①壷
// 2171 メイン③ ②壷
// 2172 メイン③ ③壷
// 2173 メイン③ ④壷
// 2174 メイン③ ⑤壷
// 2175 メイン③ ⑥壷

//■ローカルフラグ
// 100 ①レバースイッチを押した
// 101 ②レバースイッチを押した

#TAKARA_CH	49
#IT_TAKARA	112		//◇112万歩計

//--------------------------------------------------------------------
INIT
{
//環境SE
	SE(71,0)

//■地形
	//ファイル名		tipXY	   X    Y   Z   向き
	//壁から水①
	set_obj("mo20001a",	 3, 4,     0,   0,  0,    0)
	set_obj("mo20001a",	 4, 3,     0,   0,  0,    0)
	set_obj("mo20001a",	 6, 4,     0,   0,  0,    0)
	set_obj("mo20001a",	 5, 6,     0, 300,  0,  270)

	//床飾りマーク
    set_obj("mo20021a",	 5, 5,     0,   0,  1,    0)
	set_obj("mo20021a",	 3, 5,     0,   0,  1,    0)
	set_obj("mo20021a",	 7, 5,     0,   0,  1,    0)

	//天井から光
    set_obj("mo20031a",	 6, 2,     0,   0,  0,    0)
    set_obj("mo20031a",	 7, 5,     0,   0,  0,    0)
    set_obj("mo20031a",	 5, 5,     0, 900,  0,    0)
    set_obj("mo20031a",	 3, 5,     0,   0,  0,    0)
    set_obj("mo20031a",	 5, 7,     0,   0,  0,    0)

//■階段・扉

//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++

	set_chr( 90,990,	 5, 7,     0, 100,  0,		180,  0201, 6,"K0_1;")		//①エントリ 入口分岐
	set_obj("@ob20131a", 5, 7,     0, 100,  0,		180)						//①アーチ（神殿）
	set_chr(190,1400,	 5, 7,     0, 100,  0,		  0,   180, 0,";")			//アーチ（ダミー）

	set_chr( 91,990,	 4, 4,     0,   0,  0,		270,  0102, 6,"K0_0;")		//②エントリ メイン②
	set_chr(101,537,	 4, 4,     0,   0,  0,		  0,   270, 0,";")			//②階段上（神殿）
//?	set_obj("@ob20121a", 4, 4,     0,   0,  0,		270)						//②階段上（神殿）

	set_chr( 50,507,	 4, 4,   900,   0,  0,		  8,    90, 6,";")		//③扉（神殿） 一通 ②スイッチで開く
	set_chr( 51,507,	 5, 7,     0,-900,  0,		  3,     0, 6,";")		//④扉（神殿） 自由 正面
	set_chr( 52,507,	 5, 5,     0,-900,  0,		  8,   180, 6,";")		//⑤扉（神殿） 一通
	set_chr( 53,507,	 3, 5,     0,-900,  0,		  7,     0, 0,";")		//⑥扉（神殿） 閉鎖 ①スイッチで開く
	set_chr( 55,507,	 6, 2,     0, 900,  0,		  3,     0, 6,";")		//⑧扉（神殿） 自由
	set_chr( 56,507,	 8, 4,  -900,   0,  0,		  3,    90, 6,";")		//⑨扉（神殿） 自由

//■スイッチ・看板

	if ( !F2101 )
	{
	// 初回
		set_chr( 63,570,	 7, 5,     0,   0,  0,		  6,   270, 5,"M6?99 M5_99 SF2101;")	//①ボタンスイッチ
		set_chr( 80,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F2101 O1_18 WT?10 C0_53 WT?20 M4_53 WT?30 C0_0 V2_2 V2_3 V2_4;")//①ボタンスイッチ押下
	}
	else
	{
	// 押され
		set_chr( 63,570,	 7, 5,     0,   0,  0,		  7,   270, 3,";")	//①ボタンスイッチ
		set_chr( 80,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"M6_53 V2_2 V2_3 V2_4;")//①ボタンスイッチ押下
	}

	if ( !F2102 )
	{
	// 初回
		set_chr( 64,570,	 8, 4,     0,   0,  0,		  6,   270, 5,"M6?99 M5_99 SF2102")	//②ボタンスイッチ
		set_chr( 81,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F2102 O1_18 WT?10 C0_50 WT?20 M4_50 M4_52 V1_12 V2_13 WT?30 C0_0;")//②ボタンスイッチ押下
	}
	else
	{
	// 押され
		set_chr( 64,570,	 8, 4,     0,   0,  0,		  7,   270, 3,";")	//②ボタンスイッチ
		set_chr( 81,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"M6_50 M6_52 V1_12 V2_13 ;")//②ボタンスイッチ押下
	}


	set_chr( 67,645,	 5, 4,  200, -200,  0,		  0,     0, 0,"") //①ショート女神像台座
	set_chr( 68,647,	 5, 4, -200, -200,  0,		  0,     0, 0,"") //②ロング女神像台座
	set_chr( 65,644,	 5, 4,  200, -200,  0,		  0,     0, 0,"") //③ショート女神像
	if ( !F2103 )
	{
		set_chr( 66,646,	 5, 4, -200,  -50,  0,		  0,     0, 0,"") //④ロング女神像

		set_chr( 82,990,	 5, 4,     0, 100,  0,		  0,     0, 0,"WT?10 C0_99 <EV_AdjPosMegami> WT?45 V2_43 WT?45 C0_0;")
		set_chr(167,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"L1?6567 L1?6668 SF2103 O1_18 #8_82;")
	}
	else
	{
		set_chr( 66,646,	 5, 4, -200, -200,  0,		  0,     0, 0,"") //④ロング女神像
	}
	color2( 65, 45,65,100, 0,0,0)	// 神殿のショート女神像の色
	color2( 66, 45,65,100, 0,0,0)	// 神殿のロング女神像の色
	color2( 67, 45,65,100, 0,0,0)	// 神殿のショート女神像の色
	color2( 68, 45,65,100, 0,0,0)	// 神殿のロング女神像の色


//■ハニワ・壷

	if ( !F2150 )
	{
		set_chr( 40,634,	 3, 5,  -200,-350,  0,		  2,   315, 0,"I_US01 SF2150 V4_140;")	//①ハニワ
		set_chr(140,812,	 3, 5,  -200,-350,  0,		 -1,   315, 0,";")
	}
	else
	{
		set_chr(140,812,	 3, 5,  -200,-350,  0,		  0,   315, 0,";")
	}


	if ( !F2151 )
	{
		set_chr( 41,802,	 2, 4,   100,   0,  0,		  2,     0, 0,"I_$$$1 SF2151 V4_141;")	//②壷
		set_chr(141,811,	 2, 4,   100,   0,  0,		 -1,     0, 0,";")
	}
	else
	{
		set_chr(141,811,	 2, 4,   100,   0,  0,		  0,     0, 0,";")
	}


	if ( !F2152 )
	{
		set_chr( 42,802,	 3, 2,     0, 100,  0,		  2,     0, 0,"I_$$$1 SF2152 V4_142;")	//③壷
		set_chr(142,811,	 3, 2,     0, 100,  0,		 -1,     0, 0,";")
	}
	else
	{
		set_chr(142,811,	 3, 2,     0, 100,  0,		  0,     0, 0,";")
	}

	if ( !F2153 )
	{
		if ( !F2103 )
		{
			set_chr( 43,802, 5, 4,     0,-150,  0,		 -1,     0, 0,"I_FFF2 SF2153 V4_143;")	//④壷
		}
		else
		{
			set_chr( 43,802, 5, 4,     0,-150,  0,		  2,     0, 0,"I_FFF2 SF2153 V4_143;")	//④壷
		}
		set_chr(143,811,	 5, 4,     0,-150,  0,		 -1,     0, 0,";")
	}
	else
	{
		set_chr(143,811,	 5, 4,     0,-150,  0,		  0,     0, 0,";")
	}


//■宝箱
	if(IT_TAKARA<0)
	{
		set_chr( TAKARA_CH,560,	    6, 2,     0,   0,  0,		  6,     0,20,"<TK_TAKARA> V1_9;")		//①宝箱（並）
		set_chr(  9,302,		    6, 2,     0, 700,400,		 -1,   180, 0,";")//⑧敵 とびいもり
	}
	else
	{
		set_chr( TAKARA_CH,560,     6, 2,     0,   0,  0,		  7,     0, 0,";")		//①宝箱（並）
		set_chr(  9,302,		    6, 2,     0, 700,400,		  0,   180, 0,";")//⑧敵 とびいもり
	}


//■罠・障害物

	set_chr( 70,991,	 5, 6,  -350,-450,  0,		  0,020101, 0,";")	//①親
	if ( !F2120 )
		set_chr( 71,630,	 5, 6,  -350,-450,  0,		  2,   240, 0,"I_$$$2 D0_70 SF2120;")	//①樽 (浮)
	else
		set_chr( 71,630,	 5, 6,  -350,-450,  0,		  2,   240, 0,"I_$$$1 D0_70;")	//①樽 (浮)
//	chr_equip_chr( 71, 70,"TG1", 100,	0,0,180,	0,0,0);
	EV("EV_FloatingBarrel")


	set_chr(110,627,	 7, 5,     0,-900,  0,		  0,     0, 0,";")	//柵小
	color2(110, 61,81,100, 0,0,0)	// 神殿の柵の色


	
//■敵
	set_chr(  1,205,	 5, 5,     0, 200,  0,		  2,     0, 0,";")//①敵 しびれくらげ
	set_chr(  2,205,	 4, 5,     0,   0,100,		 -1,   270, 0,";")//②敵 しびれくらげ ①スイッチで出現
	set_chr(  3,205,	 6, 5,     0,   0,100,		 -1,   270, 0,";")//③敵 しびれくらげ ①スイッチで出現
	set_chr(  4,205,	 7, 4,     0, 500,100,		 -1,     0, 0,";")//④敵 しびれくらげ ①スイッチで出現 扉の向こう
	set_chr(  6,205,	 2, 4,   450,   0,  0,		  2,   270, 0,";")//⑤敵 しびれくらげ
	set_chr(  5,205,	 3, 2,     0, 450,  0,		  2,     0, 0,";")//⑥敵 しびれくらげ
	set_chr(  7,205,	 5, 3,   100,-100,  0,		  2,   225, 0,";")//⑦敵a しびれくらげ
	set_chr(  8,205,	 5, 3,  -100, 100,  0,		  2,   315, 0,";")//⑦敵b しびれくらげ
	// ch9の⑧敵は宝箱のところ
	set_chr( 12,302,	 6, 4,  -200,   0,500,		 -1,   270, 0,";")//⑪敵 とびいもり ②スイッチで出現
	set_chr( 13,205,	 5, 4,  -450,   0,  0,		 -1,   270, 0,";")//⑫敵 しびれくらげ エリア接触で出現
	set_chr( 14,302,	 6, 5,   450,   0,  0,		  2,   180, 0,";")//⑬敵 とびいもり

//■イベント
	set_chr( 83,990,	 7, 3,     0,   0,  0,		  0,   202, 6,"V1_13;")//⑫敵エリア

//■場面固有設定
	map_color(100,100,100,0);//R,G,B, time 100%
	map_spotbmp(25);//100%
}

//--------------------------------------------------------------------
EV_FloatingBarrel
{
	if ( !F71 )
	{
#BARREL1	71
		jump( BARREL1, 2, 8, 0,0,3,  0)
		wait_move( BARREL1 )
		jump( BARREL1, 2, 24, 0,0,22,  0)
		wait_move( BARREL1 )
		jump( BARREL1, 2, 8, 0,0,3,  0)
		wait_move( BARREL1 )
		jump( BARREL1, 2, 8, 0,0,-3,  0)
		wait_move( BARREL1 )
		jump( BARREL1, 2, 24, 0,0,-22,  0)
		wait_move( BARREL1 )
		jump( BARREL1, 2, 8, 0,0,-3,  0)
		wait_move( BARREL1 )

		loop
	}
}

//--------------------------------------------------------------------
EV_AdjPosMegami
{
	// 位置を補正
	jump(65, 1,	15,	 67,0, 0,	0)
	jump(66, 1,	15,	 68,0, 0,	0)
	wait_move(65)
	wait_move(66)
	SE(236,65)		// 女神像設置
	rot(65,10,0)
	rot(66,10,0)
}

#EndScriptTable
//====================================================================

