//====================================================================
//ステージトラップスクリプト
//[12013][水没神殿－メイン③]
//====================================================================

#ScriptTable

//--------------------------------------------------------------------
//■グローバルフラグ・ルートフラグはev20111.txt参照

//■ローカルフラグ
// 100 中ボス警報
// 101 中ボス登場
// 102 ②敵が出現
// 103 ③敵が出現
// 109 中ボスBGM管理

#TREASURE_CH	48
#Fx_TREASURE	2326	//☆026雷竜の前足

#TREASURE2_CH	48
#Fx_TREASURE2	2334	//☆034剣竜の前足

//--------------------------------------------------------------------
INIT
{
//環境SE
	SE(71,0)

//■地形
	//ファイル名		tipXY	   X    Y   Z   向き
	//壁から水①
	set_obj("mo20001a",	 3, 6,	   0,   0,  0,    0)
	set_obj("mo20001a",	 5, 4,	   0,-300,  0,    0)
	set_obj("mo20001a",	 5, 5,     0, 250,  0,  270)

	//床飾りマーク
	set_obj("mo20021a",	 4, 5,	   0,   0,  1,    0)
	set_obj("mo20021a",	 7, 6,	   0,   0,  1,    0)

	//天井から光
	set_obj("mo20031a",	 4, 3,  -450,   0,  0,    0)
	set_obj("mo20031a",	 4, 5,	   0,   0,  0,    0)

//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
//■階段・扉

	set_chr( 90,990,	 1, 7,   100,   0,  0,		270,  0102, 6,"K0_1;")		//①エントリ メイン③
	set_obj("@ob20111a", 1, 7,     0,   0,  0,		270)						//①階段下（神殿）
	set_chr(190,1300,	 1, 7,     0,   0,  0,		  0,   270, 0,";")			//階段下（ダミー）

	//⑥では夜マップへ移動する)
	if( F3_00_GoMoonCastle && !F4_00_StartSolo )
	{
		set_chr( 91,990,	 7, 5,     0,-100,  0,		  0,  0201, 6,"K0_12053;")	//②エントリ 中継分岐
	}
	else
	{
		set_chr( 91,990,	 7, 5,     0,-100,  0,		  0,  0201, 6,"K0_12019;")	//②エントリ 中継分岐
	}
	set_obj("@ob20131a", 7, 5,     0,-100,  0,		  0)						//②アーチ（神殿）
	set_chr(109,622,	 7, 5,     0,   0,  0,  	  0,     0, 0,";")			//②ゴール用天使
	set_chr(191,1400,	 7, 5,     0,   0,  0,		  0,     0, 0,";")			//アーチ（ダミー）

//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
	set_chr( 50,507,	 4, 7,  -650,   0,  0,  	  6,    90, 0,";")	//③扉（神殿） 開放 中ボス部屋入口
	set_chr( 51,507,	 4, 6,     0,-650,  0,  	  7,     0, 0,";")	//④扉（神殿） 閉鎖 中ボス部屋出口
	set_chr( 52,507,	 4, 5,  -900,   0,  0,  	  8,   270, 6,";")	//⑤扉（神殿） 一通 中央部屋
	set_chr( 53,507,	 4, 5,     0,-900,  0,  	  8,     0, 6,";")	//⑥扉（神殿） 一通 中央部屋
	set_chr( 54,507,	 4, 5,   900,   0,  0,  	  8,    90, 6,";")	//⑦扉（神殿） 一通 中央部屋
	set_chr( 55,507,	 3, 5,     0, 900,  0,  	  6,     0, 0,";")	//⑧扉（神殿） 開放 左雑魚部屋
	set_chr( 56,507,	 3, 4,     0,-900,  0,  	  6,     0, 0,";")	//⑨扉（神殿） 開放 左雑魚部屋
	set_chr( 57,507,	 4, 4,     0,-900,  0,  	  6,     0, 0,";")	//⑩扉（神殿） 開放 上雑魚部屋
	set_chr( 58,507,	 5, 4,     0, 900,  0,  	  6,     0, 0,";")	//⑪扉（神殿） 開放 上雑魚部屋

//■スイッチ・看板
	set_chr( 60,658,	 3, 7,   900,-175,  0,  	  0,     0,	0,";")	//①中ボス看板

//■ハニワ・壷

	if ( !F2170 )
	{
		set_chr( 40,802,	 3, 7,  -375,-375,  0,		  2,    90, 0,"I_$$$1 SF2170 V4_140;")	//①壷 左下
		set_chr(140,811,	 3, 7,  -375,-375,  0,		 -1,    90, 0,";")
	}
	else
	{
		set_chr(140,811,	 3, 7,  -375,-375,  0,		  0,    90, 0,";")
	}


	if ( !F2171 )
	{
		set_chr( 41,802,	 2, 6,   375, 375,  0,		  2,   180, 0,"I_$$$1 SF2171 V4_141;")	//②壷 左下
		set_chr(141,811,	 2, 6,   375, 375,  0,		 -1,   180, 0,";")
	}
	else
	{
		set_chr(141,811,	 2, 6,   375, 375,  0,		  0,   180, 0,";")
	}



	if ( !F2172 )
	{
		set_chr( 42,802,	 4, 3,  -375,-375,  0,		  2,    90, 0,"I_$$$1 SF2172 V4_142;")	//③壷 上
		set_chr(142,811,	 4, 3,  -375,-375,  0,		 -1,    90, 0,";")
	}
	else
	{
		set_chr(142,811,	 4, 3,  -375,-375,  0,		  0,    90, 0,";")
	}


	if ( !F2173 )
	{
		set_chr( 43,802,	 3, 2,   375, 375,  0,		  2,   180, 0,"I_$$$1 SF2173 V4_143;")	//④壷 上
		set_chr(143,811,	 3, 2,   375, 375,  0,		 -1,   180, 0,";")
	}
	else
	{
		set_chr(143,811,	 3, 2,   375, 375,  0,		  0,   180, 0,";")
	}



	if ( !F2174 )
	{
		set_chr( 44,802,	 5, 6,   375,-375,  0,		  2,     0, 0,"I_$$$1 SF2174 V4_144;")	//⑤壷 上
		set_chr(144,811,	 5, 6,   375,-375,  0,		 -1,     0, 0,";")
	}
	else
	{
		set_chr(134,811,	 5, 6,   375,-375,  0,		  0,     0, 0,";")
	}


	if ( !F2175 )
	{
		set_chr( 45,802,	 6, 5,  -375, 375,  0,		  2,     0, 0,"I_$$$1 SF2175 V4_145;")	//⑥壷 上
		set_chr(145,811,	 6, 5,  -375, 375,  0,		 -1,     0, 0,";")
	}
	else
	{
		set_chr(145,811,	 6, 5,  -375, 375,  0,		  0,     0, 0,";")
	}

//■宝箱
	set_chr( 49,626,	 7, 6,     0,   0,  0,  	  0,     0,10,"!F2924 I_SLOT SF2924 <EV_SlotDarken>;")	//①スロットマシン
	if ( F2924 )
	{
		MOT( 49, 3, 1);
		EV("EV_SlotDarken")
	}

	// ②宝箱（上）
	if ( GW_LV_PLATE==0 )
	{
		if( !Fx_TREASURE )
			set_chr( TREASURE_CH,561,	 4, 5,     0,   0,  0,  	 6,   0,20,"<TK_TREASURE>;")
		else
			set_chr( TREASURE_CH,561,	 4, 5,     0,   0,  0,  	 7,   0, 0,";")
	}
	else
	{
		if( !Fx_TREASURE2 )
			set_chr( TREASURE2_CH,561,	 4, 5,     0,   0,  0,  	 6,   0,20,"<TK_TREASURE2>;")
		else
			set_chr( TREASURE2_CH,561,	 4, 5,     0,   0,  0,  	 7,   0, 0,";")
	}

//■罠・障害物

//■敵
	if ( !F2100 )
	{
		set_chr(  1,351,	 4, 6,     0,-300,  0,		 -1,     0, 9,"F101	WT?60 V2_99 <EV_BossItemSpawner>;")	//①敵a えれくとくらげ
		set_chr(  2,205,	 4, 7,  -250,-900,  0,		 -1,     0, 9,"F101	WT?5 V2_99;")	//①敵b しびれくらげ
		set_chr(  3,205,	 4, 7,   250,-900,  0,		 -1,     0, 9,"F101	WT?5 V2_99;")	//①敵c しびれくらげ

		set_chr( 80,990,	 4, 7,     0,-500,  0,		  0,071001, 6,"SF100;")//①敵 中ボス部屋 戦闘開始エリア 
		set_chr( 81,990,	 4, 7,     0, 100,  0,		  0,070111, 6,"SF100;")//①敵 中ボス部屋 戦闘開始エリア 
		set_chr( 82,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F100 S0_1 WT?120 #6_83;")//警報出現
		set_chr( 83,990,	 4, 7,     0,-900,  0,		  0,071029, 0,"M5_50 SF101;")//中ボス出現
		set_chr( 88,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F1 WT?10 O1_18 SF2100 <EV_NormalBGM> WT?30 C0_51 WT?20 M4_50 M4_51 M4_52 M4_53 M4_54 WT?30 C0_0;")//中ボス戦闘終了

		// 中ボスBGM
		set_chr(160,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(F109 <EV_BossBGM> WT?90 !F101 !F109 <EV_NormalBGM> WT?90);");
		set_chr(161,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"!F2100 F101 SF109");	// ボスが生きていて、ボス戦闘中ならば109をセット
		set_chr(162,990,	 4, 7,     0,-900,  0,		  0,071029, 6,"!F2100 F100 SF109");		// ボスが生きていて、警報がなっていて、ボス部屋内ならば109をセット
		set_chr(163,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"RF109");			// 109をクリア
	}
	else
	{
		set_chr(118,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"M6_51;")// ④扉 開き
	}

	// ボス
	set_chr(  5,168,	 3, 4,   200, 500,  0,		 -1,   270, 9,"F102 WT?55 V2_99;")	//②敵a そーどふぃっしゅ
	set_chr(  6,168,	 3, 4,  -200, 500,  0,		 -1,    90, 9,"F102 WT?35 V2_99;")	//②敵b そーどふぃっしゅ

	set_chr( 10,168,	 4, 4,   500, 200,  0,		 -1,     0, 9,"F103 WT?35 V2_99;")	//③敵a そーどふぃっしゅ
	set_chr( 11,302,	 5, 4,  -500,-100,500,		 -1,    90, 9,"F103 WT?15 V1_99;")	//③敵b とびいもり
	set_chr( 12,302,	 5, 4,  -800, 300,500,		 -1,    90, 9,"F103 WT?5  V1_99;")	//③敵c とびいもり
	set_chr( 13,168,	 4, 4,   200,-200,  0,		 -1,   225, 9,"F104 WT?25 V2_99;")	//③敵d そーどふぃっしゅ
	set_chr( 14,168,	 5, 4,  -300, 100,  0,		 -1,   270, 9,"F104 WT?5  V2_99;")	//③敵e そーどふぃっしゅ
	set_chr( 15,168,	 4, 4,   100, 100,  0,		 -1,   315, 9,"F104 WT?45 V2_99;")	//③敵f そーどふぃっしゅ

	set_chr( 18,251,	 2, 7,   450,   0,  0,		  2,     0, 0,";")//④敵 ばっとさん
	set_chr( 19,302,	 3, 3,   900,   0,  0,		  2,    90, 0,";")//⑤敵 とびいもり
	set_chr( 20,251,	 5, 5,     0,   0,  0,		  2,   180, 0,";")//⑥敵 ばっとさん
	set_chr( 21,302,	 6, 6,     0,   0,  0,		  2,   180, 0,";")//⑦敵 とびいもり

//■イベント
	set_chr( 84,990,	 3, 4,     0,1100,  0,		  0,  1001, 6,"SF102 M5_55 M5_56 ;")//②敵エリア 
	set_chr( 85,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F5 F6 WT?10 O1_18  C0_56 WT?20 M4_55 M4_56 WT?30 C0_0;")

	set_chr( 86,990,	 4, 4,   900,   0,  0,		  0,   110, 6,"SF103 M5_57 M5_58 ;")//③敵エリア 
	set_chr( 87,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F10 F11 F12 SF104 F13 F14 F15 WT?10 O1_18  C0_58 WT?20 M4_57 M4_58 WT?30 C0_0;")

//■場面固有設定
	map_color(100,100,100,0);//R,G,B, time 100%
	map_spotbmp(25);//100%
}

//--------------------------------------------------------------------
EV_SlotDarken
{
	wait(15)
	color2( 49, 70,70,70,,0,0,0)		// スロット暗く
}

//--------------------------------------------------------------------
EV_BossBGM
{
	stop_BGM(30)
	wait(30)
	BGM(35)
}

//--------------------------------------------------------------------
EV_NormalBGM
{
	stop_BGM(30)
	wait(30)
	BGM(22)
}

//--------------------------------------------------------------------
EV_BossItemSpawner
{
	set_chr(164,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F1 I_FFF3 I_FFF3 I_FFF3;");
	chr_equip_chr(164, 1,"Bone_Head", 100,	0,0,0,	0,0,0);
}

#EndScriptTable
//====================================================================

