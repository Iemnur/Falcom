//====================================================================
//ステージトラップスクリプト
//[15032][城－地下②]
//====================================================================

#ScriptTable

//--------------------------------------------------------------------
//■グローバルフラグ・ルートフラグはev52312.txt参照

//■ローカルフラグ
// 104 ②敵が出現
// 105 ⑥敵が出現
// 106 ⑩敵が出現
// 107 ⑪敵が出現
// 108 ⑫敵が出現
// 111,114,117 ⑩敵ボタン戻しイベントワーク
// 112,115,118 ⑪敵ボタン戻しイベントワーク
// 113,116,119 ⑫敵ボタン戻しイベントワーク

#TAKARA_CH		47
#IT_TAKARA		044		//◇044フェアリーマント

//--------------------------------------------------------------------
INIT
{
//環境
	SE(66,0)

//■地形
	set_obj("mp52172",	 6, 5,  -550,-900,0,	 0) //空牢
	set_obj("mp52192",	 5, 6,   350,-550,0,	 0) //水

//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
//■階段・扉

	set_chr( 90,990,	 8, 7,     0,   0,  0,		 90,  0102, 6,"K0_1;")		//①エントリ 地下①
	set_obj("@obx0042a", 8, 7,     0,   0,  0,		 90)						//①階段上（地下）
	set_chr(190,1300,	 8, 7,	   0,   0,  0,		  0,    90, 0,";")			//階段下（ダミー）

	set_chr( 91,990,	 6, 6,     0, 100,  0,		  0,  0201, 6,"K0_0;")		//②エントリ 地下③
	set_obj("@obx0052a", 6, 6,     0, 100,  0,		  0)						//②階段下（地下）
	set_chr(191,1301,	 6, 6,     0, 100,  0,		  0,     0, 0,";")			//階段上（ダミー）

	set_chr( 50,505,	 7, 4,  -900,   0,  0,		  8,    90, 6,";")	//③扉（地下）一通
	set_chr( 51,505,	 4, 4,     0, 600,  0,		  8,     0, 6,";")	//④扉（地下）一通
	set_chr( 52,505,	 4, 7,   900,   0,  0,		  8,   270, 6,";")	//⑤扉（地下）一通

	set_chr( 53,505,	 6, 7,     0,-900,  0,		  8,   180, 6,";")	//⑥扉（地下）一通
	set_chr( 54,505,	 6, 7,     0, 900,  0,		  7,     0, 0,";")	//⑦扉（地下）閉鎖

	set_chr( 55,505,	 6, 3,  -900,   0,  0,		  8,    90, 6,";")	//⑧扉（地下）一通
	set_chr( 56,505,	 6, 7,  -900,   0,  0,		  8,   270, 6,";")	//⑨扉（地下）一通

//■スイッチ・看板
	if ( !F2103 )
	{
	// 初回
		set_chr( 57,570,	 6, 5,     0,   0,  0,		  6,     0, 5,"M6?99 M5_99 SF2103")	//①ボタンスイッチ
		set_chr( 80,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F2103 O1_18 WT?10 C0_50 WT?20 M4_50 WT?30 C0_0 #6_83;")	//①ボタンスイッチを押した
	}
	else
	{
	// 押され
		set_chr( 57,570,	 6, 5,     0,   0,  0,		  7,     0, 5,"M6?99 M5_99 SF2103")	//①ボタンスイッチ
		set_chr( 80,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"M6_50 #6_83;")	//①ボタンスイッチを押した
	}


	if ( !F2104 )
	{
	// 初回
		set_chr( 58,570,	 5, 5,     0,   0,  0,		  6,     0, 5,"M6?99 M5_99 SF2104")	//②ボタンスイッチ
		set_chr( 81,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F2104 O1_18 WT?10 C0_51 WT?20 M4_51 WT?30 C0_0 #6_84;")	//②ボタンスイッチを押した
	}
	else
	{
	// 押され
		set_chr( 58,570,	 5, 5,     0,   0,  0,		  7,     0, 5,"M6?99 M5_99 SF2104")	//②ボタンスイッチ
		set_chr( 81,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"M6_51 #6_84;")	//②ボタンスイッチを押した
	}


	if ( !F2105 )
	{
	// 初回
		set_chr( 59,570,	 5, 6,     0,   0,  0,		  6,     0, 5,"M6?99 M5_99 SF2105")	//③ボタンスイッチ
		set_chr( 82,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F2105 O1_18 WT?10 C0_52 WT?20 M4_52 WT?30 C0_0 #6_85;")	//③ボタンスイッチを押した
	}
	else
	{
	// 押され
		set_chr( 59,570,	 5, 6,     0,   0,  0,		  7,     0, 5,"M6?99 M5_99 SF2105")	//③ボタンスイッチ
		set_chr( 82,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"M6_52 #6_85;")	//③ボタンスイッチを押した
	}

	set_chr( 60,571,	 6, 4,  -550,   0, 40,		  6,   270, 5,"M6?99 M5_99")	//④レバースイッチ

	set_chr( 61,571,	 5, 7,  -550, 900, 40,		  6,   270, 5,"M6?99 M5_99")	//⑤レバースイッチ ⑧敵が出現
	set_chr( 62,571,	 5, 9,   250,-250, 40,		  6,   270, 5,"M6?99 M5_99")	//⑥レバースイッチ

	set_chr( 88,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"(M7?62 M6?61 M5_61 M6?61 M4_62);")	//⑥レバースイッチ同期




	if ( !F2126 )
	{
		set_chr(160,990,	 0, 0,     0,   0,  0,		  6,     0,	8,"M6!60 WT?10 O1_18 SF2126;")
	}

	if ( !F2127 )
	{
		set_chr(161,990,	 0, 0,     0,   0,  0,		  6,     0,	8,"M6!61 WT?10 O1_18 SF2127;")
	}

//	if ( !F2128 )
//	{
//		set_chr(162,990,	 0, 0,     0,   0,  0,		  6,     0,	8,"M6!62 WT?10 O1_18 SF2128;")
//	}
// 2128 地下② レバースイッチ(初回)



//	set_chr( 63,570,	 5, 9,     0,   0,  0,		  6,     0, 5,"M6?99 M5_99 SF109")	//⑦ボタンスイッチ
	if ( !F2106 )
	{
	// 初回
		set_chr( 63,570,	 5, 9,     0,   0,  0,		  6,     0, 5,"M6?99 M5_99 SF2106")	//⑦ボタンスイッチ
		set_chr( 87,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F2106 O1_18 WT?10 C0_54 WT?20 M4_54 WT?30 C0_0;")	//⑦ボタンスイッチを押した
	}
	else
	{
	// 押され
		set_chr( 63,570,	 5, 9,     0,   0,  0,		  7,     0, 3,";")	//⑦ボタンスイッチ
		MOT( 54, 6, 0)
	}

//■ハニワ・壷
	if ( !F2160 )
	{
		set_chr( 40,802,	 5, 5,     0,   0, 37,		  2,     0, 0,"I_$$$1 SF2160 V4_140;")	//①壷
		set_chr(140,811,	 5, 5,     0,   0, 37,		 -1,     0, 0,";")
		chr_equip_chr( 40, 58,"switch02",  100,   0,0,0,	0,0,37);
		chr_equip_chr(140, 58,"switch02",  100,   0,0,0,	0,0,37);
	}
	else
	{
		set_chr(140,811,	 5, 5,     0,   0, 37,		  0,     0, 0,";")
		chr_equip_chr(140, 58,"switch02",  100,   0,0,0,	0,0,37);
	}


	if ( !F2161 )
	{
		set_chr( 41,802,	 6, 8,  -300,-320,  0,		  2,    90, 0,"I_$$$1 SF2161 V4_141;")	//②壷
		set_chr(141,811,	 6, 8,  -300,-320,  0,		 -1,    90, 0,";")
	}
	else
	{
		set_chr(141,811,	 6, 8,  -300,-320,  0,		  0,    90, 0,";")
	}


	if ( !F2162 )
	{
		set_chr( 42,802,	 6, 8,    50,-150,  0,		  2,   270, 0,"I_$$$1 SF2162 V4_142;")	//③壷
		set_chr(142,811,	 6, 8,    50,-150,  0,		 -1,   270, 0,";")
	}
	else
	{
		set_chr(142,811,	 6, 8,    50,-150,  0,		  0,   270, 0,";")
	}


//■宝箱
	set_chr( 49,562,	 6, 8,  -260,-150,  0,		  2,   380, 5,"#8_99 WT?15 I_$$$1 WT?30 D2_99;")	//②木箱a ダミー
	set_chr( 48,562,	 6, 8,  -180,  40,  0,		  2,   150, 5,"#8_99 WT?15 I_$$$1 WT?30 D2_99;")	//③木箱c ダミー


	if(IT_TAKARA<1)
		set_chr( TAKARA_CH,560,	   6, 8,   375, 375,  0,  	   6,   135,20,"<TK_TAKARA>;")		//④宝箱（並）
	else
		set_chr( TAKARA_CH,560,    6, 8,   375, 375,  0,  	   7,   135, 0,";")		//④宝箱（並）
	

	if ( !F2120 )
	{
		set_chr( 46,561,		 4, 6,     0,   0,  0,		  2,   180, 5,"V4_20 D1_99;")	//①宝箱（上）ミミック
		set_chr( 20,230,		 4, 6,     0,   0,  0,		 -1,   180, 0,"SF2120;")		//⑦敵 みみっく
	}

//■罠・障害物

	set_chr(118,627,	 5, 3,   900, 400,  0,		  0,    90, 0,";")	// 柵小
	set_chr(119,627,	 5, 7,   900, 400,  0,		  0,    90, 0,";")	// 柵小
	color2(118, 63,78,100, 0,0,0)	// 地下牢の柵の色
	color2(119, 63,78,100, 0,0,0)	// 地下牢の柵の色

	set_chr(120,808,	 7, 7,     0,   0,  0,		  3,     0, 8,"(R3_100);")	//①トゲ球a
	set_chr(121,808,	 7, 7,     0,   0,  0,		  3,     0, 8,"(R3_250);")	//①トゲ球b
	set_chr(122,808,	 7, 7,     0,   0,  0,		  3,     0, 8,"(R3_400);")	//①トゲ球c
	set_chr(123,808,	 7, 7,     0,   0,  0,		  3,     0, 8,"(R3_550);")	//①トゲ球c

	set_chr(124,808,	 7, 6,   -75, 750,  0,		  3,     0, 8,"(WT?30 Z2_300 WT?30 Z2_-300);")	//②トゲ球1a
	set_chr(125,808,	 7, 6,    75, 750,  0,		  3,     0, 8,"(WT?30 Z2_300 WT?30 Z2_-300);")	//②トゲ球1b

	set_chr(126,808,	 7, 6,   -75,-750,  0,		  3,     0, 8,"(WT?30 Z2_300 WT?30 Z2_-300);")	//②トゲ球1a
	set_chr(127,808,	 7, 6,    75,-750,  0,		  3,     0, 8,"(WT?30 Z2_300 WT?30 Z2_-300);")	//②トゲ球1b

	set_chr(128,808,	 7, 6,   -75,   0,300,		  3,     0, 8,"(WT?30 Z2_-300 WT?30 Z2_300);")	//②トゲ球1a
	set_chr(129,808,	 7, 6,    75,   0,300,		  3,     0, 8,"(WT?30 Z2_-300 WT?30 Z2_300);")	//②トゲ球1b

	set_chr( 65,629,	 6, 3,     0,-375,  0,		  2,     0, 8,"(M6!60 WT?15 M4_55 #0_55 M3_99 Y9_-2525 M2_99 WT?45 M4_99 Y2_2525 M2_99 M8_55 #6_55 M4_60 M6?60)")//⑤トゲ壁
	set_chr( 66,629,	 5, 3,     0,-375,  0,		  2,     0, 8,"(      WT?15             M3_99 Y9_-2525 M2_99 WT?45 M4_99 Y2_2525 M2_99 )")//⑥トゲ壁

	set_chr( 67,809,	 4, 6,  -300,-300,  0,		  2,     0, 8,"WT?10 M8_99 #0_99;") //⑦トゲ床
	set_chr( 68,809,	 4, 6,   300,-300,  0,		  2,     0, 8,"WT?20 M8_99 #0_99;") //⑦トゲ床
	set_chr( 69,809,	 4, 6,   300, 300,  0,		  2,     0, 8,"WT?30 M8_99 #0_99;") //⑦トゲ床
	set_chr( 70,809,	 4, 6,  -300, 300,  0,		  2,     0, 8,"WT?40 M8_99 #0_99;") //⑦トゲ床

	set_chr( 71,629,	 5, 7,     0,-375,  0,		  0,     0, 8,"(M6!61 WT?1 #3_61 #3_62 M4_56 #0_56        M3_99 Y4_-1850 M2_99 WT?45 M4_99 Y2_1850  M2_99 WT?210 M8_56 #6_56 M4_61 M6?61 #5_61 #5_62 );")//⑧トゲ壁a
	set_chr( 72,629,	 5, 8,     0, 325,  0,		  0,   180, 8,"(M6!61 WT?1 #3_61 #3_62             WT?210 M3_99 Y4_1850  M2_99 WT?45 M4_99 Y2_-1850 M2_99                          M6?61 #5_61 #5_62 );")//⑧トゲ壁b


	set_chr( 73,590,	 5, 8,     0, 600,  0,		  2,     0, 0,";") //⑨重し

//■敵
	set_chr(  2,265,	 7, 7,   -25,-700,  0,		  2,     0, 0,";") //①敵a めたじぇりー
	set_chr(  3,265,	 7, 7,    25,-1250, 0,		  2,     0, 0,";") //①敵b めたじぇりー

	set_chr(  4,140,	 7, 5,     0,-200,500,		 -1,     0, 8,"F104 V1_99;")	//②敵 じごくぐるま

	set_chr(  5,263,	 5, 4,   150, 150,  0,		  2,     0, 0,";") //⑤敵a ですくろうらー
	set_chr(  6,264,	 5, 4,   200, 250,  0,		  2,    90, 0,";") //⑤敵b くろうらー
	set_chr(  7,264,	 5, 4,   100,-100,  0,		  2,   180, 0,";") //⑤敵c くろうらー
	set_chr(  8,264,	 5, 4,   200,-250,  0,		  2,   270, 0,";") //⑤敵d くろうらー


	set_chr( 11,140,	 4, 5,     0,-800,500,		 -1,     0, 8,"F105 V1_99;")	//⑥敵a じごくぐるま
	set_chr( 12,140,	 4, 5,     0, 800,500,		 -1,   180, 8,"F105 V1_99;")	//⑥敵b じごくぐるま

	set_chr( 26,266,	 5, 8,   300,   0,500,		 -1,   180, 8,"M6!61 WT?60 V1_99;") //⑧敵 青トカゲ②

	set_chr( 24,138,	 6, 7,     0,-250,  0,		  2,    90, 0,";") //⑨敵a ぱにっしゃー
	set_chr( 25,138,	 6, 7,     0, 250,  0,		  2,    90, 0,";") //⑨敵b ぱにっしゃー

	set_chr( 21,138,	 7, 5,  -750,   0,400,		 -1,    90, 8,"F106 V1_99 M6_99 #8_111;") //⑩敵 ぱにっしゃー 落下してきてボタンを戻す
	set_chr( 22,138,	 5, 4,     0, 850,400,		 -1,     0, 8,"F107 V1_99 M6_99 #8_112;") //⑪敵 ぱにっしゃー 落下してきてボタンを戻す
	set_chr( 23,138,	 4, 6,   600,   0,400,		 -1,    90, 8,"F108 V1_99 M6_99 #8_113;") //⑫敵 ぱにっしゃー 落下してきてボタンを戻す

//■イベント

	set_chr( 83,990,	 7, 5,     0,-450,  0,		  0,  0704, 0,"SF106 <EV_ExecuterPushButton1>;") //⑩敵エリア
	set_chr( 84,990,	 5, 4,     0, 300,  0,		  0,  0603, 0,"SF107 <EV_ExecuterPushButton2>;") //⑪敵エリア
	set_chr( 85,990,	 4, 6,     0, 450,  0,		  0,  0603, 0,"SF108 <EV_ExecuterPushButton3>;") //⑫敵エリア

	set_chr( 86,990,	 4, 5,     0,   0,  0,		  0,  0502, 6,"SF105;") //⑥敵エリア

	set_chr( 89,990,	 7, 5,     0, 450,  0,		  0,  0501, 6,"SF104;") //②敵エリア

	set_chr(110,990,	 0, 0,     0,   0,  0,		  0,     0, 8,"F24 F25 WT?10 O1_18 WT?20 C0_53 WT?20 M4_53 WT?30 C0_0;")	//最後の扉

	set_chr(111,990,	 0, 0,     0,   0,  0,		  0,     0, 0,"M2?21 SF114 WT?50 !F21 M4_57 WT?10 M5_50 RF2103 F2103 M5_57 WT?10 C0_50 WT?20 M4_50 WT?30 C0_0;") //⑩敵 ボタン戻し
	set_chr(112,990,	 0, 0,     0,   0,  0,		  0,     0, 0,"M2?22 SF115 WT?50 !F22 M4_58 WT?10 M5_51 RF2104 F2104 M5_58 WT?10 C0_51 WT?20 M4_51 WT?30 C0_0;") //⑪敵 ボタン戻し
	set_chr(113,990,	 0, 0,     0,   0,  0,		  0,     0, 0,"M2?23 SF116 WT?50 !F23 M4_59 WT?10 M5_52 RF2105 F2105 M5_59 WT?10 C0_52 WT?20 M4_52 WT?30 C0_0;") //⑫敵 ボタン戻し


//■場面固有設定
}

//--------------------------------------------------------------------
#EPB_M_SPD 10
#EPB_R_SPD 7

EV_ExecuterPushButton1
{
	if(!F114)
	{
		if(!F111)
		{
			F_set(111)
			MOT(21, 5, 15)	// イベント用走り
			F_set_chr(21,CF_NO_CLIP2)
		}
		move(21,1,EPB_M_SPD,57,0,0,250)
		rot_chr(21,EPB_R_SPD,57)
		wait(20)
		loop
	}
	else
	{
		if(!F117)
		{
			F_set(117)
			MOT(21, 6, 15)	// イベント用攻撃
			rot_chr(21,EPB_R_SPD,57)
		}
		wait(20)
		loop
	}
}

//--------------------------------------------------------------------
EV_ExecuterPushButton2
{
	if(!F115)
	{
		if(!F112)
		{
			F_set(112)
			MOT(22, 5, 15)	// イベント用走り
			F_set_chr(22,CF_NO_CLIP2)
		}
		move(22,1,EPB_M_SPD,58,0,0,250)
		rot_chr(22,EPB_R_SPD,58)
		wait(20)
		loop
	}
	else
	{
		if(!F118)
		{
			F_set(118)
			MOT(22, 6, 15)	// イベント用攻撃
			rot_chr(22,EPB_R_SPD,58)
		}
		wait(20)
		loop
	}
}

//--------------------------------------------------------------------
EV_ExecuterPushButton3
{
	if(!F116)
	{
		if(!F113)
		{
			F_set(113)
			MOT(23, 5, 15)	// イベント用走り
			F_set_chr(23,CF_NO_CLIP2)
		}
		move(23,1,EPB_M_SPD,59,0,0,250)
		rot_chr(23,EPB_R_SPD,59)
		wait(20)
		loop
	}
	else
	{
		if(!F119)
		{
			F_set(119)
			MOT(23, 6, 15)	// イベント用攻撃
			rot_chr(23,EPB_R_SPD,59)
		}
		wait(20)
		loop
	}
}

#EndScriptTable
//====================================================================

