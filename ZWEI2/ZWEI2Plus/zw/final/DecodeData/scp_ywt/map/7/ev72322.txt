//====================================================================
//ステージトラップスクリプト
//[17032][異－ボス２②]
//====================================================================

#ScriptTable

//--------------------------------------------------------------------
//■グローバルフラグ・ルートフラグはev72312.txt参照

//■ローカルフラグ
// 110 雪球距離ワーク

#TAKARA_CH	49
#IT_TAKARA	073		//◇073勇士の手袋

#WOODBOX_CH	48
#IT_WOODBOX	190		//∴190エリンギ

//--------------------------------------------------------------------
INIT
{
//環境SE
	SE(68,0)

	set_obj("obx0504",	 4, 5,     0, -50,  0, 270) //毒沼
	set_obj("obx0504",	 6, 5,     0, -50,  0, 270) //毒沼
	set_obj("obx0504",	 5, 2,     0,   0,  0,  90) //毒沼
	
//■地形
	F_set_chr(PLAYER1, CF_NO_FALL )
	F_set_chr(PLAYER2, CF_NO_FALL )
	F_set_chr(PET, CF_NO_FALL )

	set_obj2("obx7200k",  5, 6,     0,-900,  0,   0) //↓
	set_obj2("obx7200k",  5, 6,     0, 900,  0, 180) //↑

	set_obj2("obx7200k",  5, 8,     0,-900,  0,   0) //↓
	set_obj2("obx7200k",  5, 8,     0, 900,  0, 180) //↑

//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
//■階段・扉
	set_chr( 90,990,	 5,10,     0, -50,  0,		180,  0201, 6,"K0_1;")	//①エントリ ボス２①
	set_obj("@obx2102a", 5,10,     0,   0,  0,		180)					//①階段下（異３）
	set_chr(190,1300,	 5,10,     0,   0,  0,		  0,   180, 0,";")		//階段下（ダミー）

	set_chr( 91,990,	 5, 0,     0,  50,  0,		  0,  0201, 6,"K0_0;")	//②エントリ ボス２③
	set_obj("@obx2112a", 5, 0,     0,   0,  0,		  0)					//②階段上（異３）
	set_chr(191,1301,	 5, 0,     0,   0,  0,		  0,     0, 0,";")		//階段上（ダミー）

	set_chr( 50,1204,	 5, 1,     0, 100,  0,		  8,   180, 6,";")	//③扉（異３） 一通
	set_chr( 51,1204,	 5, 1,     0,-100,  0,		  8,   180, 6,";")	//④扉（異３） 一通

	// チェックポイント
	set_chr( 92,990,	 5, 6,     0,-900,  0,		180,070301, 6,"k2_0")
	set_chr( 93,990,	 5, 6,     0, 900,  0,		  0,070301, 6,"k3_0")
	set_chr( 94,990,	 5, 8,     0,-900,  0,		180,070301, 6,"k4_0")
	set_chr( 95,990,	 5, 8,     0, 900,  0,		  0,070301, 6,"k5_0")

//■スイッチ・看板

	if ( !F2120 )
	{
	// 初回
		set_chr( 55,570,	 4, 3,	   0,   0,  0,		  6,     0, 5,"M6?99 M5_99 SF2120;")	//①ボタンスイッチ
		set_chr( 80,990,	 0, 0,     0,   0,  0,  	  0,     0, 8,"F2120 O1_18 WT?10 C0_50 #3_66 WT?20 M4_50 WT?30 C0_0 #8_66;")//①ボタンスイッチ押下
	}
	else
	{
	// 押され
		set_chr( 55,570,	 4, 3,	   0,   0,  0,		  7,     0, 3,";")	//①ボタンスイッチ
		MOT( 50, 6, 0 )
	}

	if ( !F2121 )
	{
	// 初回
		set_chr( 56,570,	 6, 3,	   0,   0,  0,		  6,     0, 5,"M6?99 M5_99 SF2121;")	//②ボタンスイッチ
		set_chr( 81,990,	 0, 0,     0,   0,  0,  	  0,     0, 8,"F2121 O1_18 WT?10 C0_51 #3_67 WT?20 M4_51 WT?30 C0_0 #8_67;")//②ボタンスイッチ押下
	}
	else
	{
	// 押され
		set_chr( 56,570,	 6, 3,	   0,   0,  0,		  7,     0, 3,";")	//②ボタンスイッチ
		MOT( 51, 6, 0 )
	}

//■ハニワ・壷

	if (!F2160)
	{
		set_chr( 40,802,	 4, 8,     0,   0,  0,		  2,    80, 0,"I_$$$1 SF2160 V4_140;")	//①壷
		set_chr(140,811,	 4, 8,     0,   0,  0,		 -1,    80, 0,";")
	}
	else
	{
		set_chr(140,811,	 4, 8,     0,   0,  0,		  0,    80, 0,";")
	}


	if (!F2161)
	{
		set_chr( 41,802,	 6, 8,     0,   0,  0,		  2,   160, 0,"I_$$$1 SF2161 V4_141;")	//②壷
		set_chr(141,811,	 6, 8,     0,   0,  0,		 -1,   160, 0,";")
	}
	else
	{
		set_chr(141,811,	 6, 8,     0,   0,  0,		  0,   160, 0,";")
	}


	if (!F2162)
	{
		set_chr( 42,802,	 4, 6,     0,   0,  0,		  2,   240, 0,"I_$$$1 SF2162 V4_142;")	//③壷
		set_chr(142,811,	 4, 6,     0,   0,  0,		 -1,   240, 0,";")
	}
	else
	{
		set_chr(142,811,	 4, 6,     0,   0,  0,		  0,   240, 0,";")
	}


	if (!F2163)
	{
		set_chr( 43,802,	 6, 6,     0,   0,  0,		  2,   320, 0,"I_$$$1 SF2163 V4_143;")	//④壷
		set_chr(143,811,	 6, 6,     0,   0,  0,		 -1,   320, 0,";")
	}
	else
	{
		set_chr(143,811,	 6, 6,     0,   0,  0,		  0,   320, 0,";")
	}


//■宝箱
	if ( !Fx_732Food1 )
		set_chr( WOODBOX_CH,562,		6,3, 475,  0,  0,  	 6,    90,20,"<TK_WOODBOX><EV_SetGetFood1>;")
	else
		set_chr( WOODBOX_CH,562,		6,3, 475,  0,  0,  	 7,    90, 0,";")

//■罠・障害物
	if(WK_ENTRY==91)//階段91 から来た時（帰り）
	{
		set_chr( 81,990,	 0, 0,     0,   0,  0,		  0,     0, 0,"WT?10 D1_1;")
//xx	set_chr( 65,711,	 5, 4,     0,   0,200,		  1,     0, 5,"#8_99 M3_99 D0_165 T0_99 Y5_-3150 V1_1 <EV_BossActivate65> E0_20540 #8_81 <EV_MoonVanish65> WT?50 D0_99;") //①雪球
		set_chr( 65,711,	 5, 4,     0,   0,200,		  1,     0, 5,"#8_99 M3_99 D0_165 T0_99 Y5_-3150 V4_1 E0_20540 O0_1322 #8_81 <EV_MoonVanish65> WT?50 D0_99;") //①雪球
		set_chr(  1,304,	 5, 5,     0,1050,-250,		 -1,   180, 0,"<EV_BossFinish65> E0_24674;")	//①敵 むーんぶりーど

		// 逆走では宝箱は出ない
	}
	else
	{
		set_chr( 65,711,	 5, 4,     0,   0,200,		  1,   180, 5,"#8_99 M3_99 D0_165 T4_99 Y5_3600 Z2_-75 O0_243 Z2_-50 M-_99 WT?30 <EV_MoonVanish65> V4_1 <EV_BossActivate65> E0_20540 O0_1322 WT?30 D0_99;") //①雪球
		set_chr(  1,304,	 5, 2,     0,   0,-250,		 -1,     0, 0,"<EV_BossFinish65> E0_24674;")	//①敵 むーんぶりーど
	}
	set_chr(165,991,	 5, 4,     0,   0,  0,		  1,070501, 0,";")
	color2( 65, 100,75,25, 0, 0,0)	// 異次元の雪球の色（月っぽい）

	set_chr( 66,711,	 4, 5, 	   0,-450,200,		  1,   180, 5,"O0_1311 #8_99 M3_99 D0_166 T4_99 Y5_3100 #8_55 Y5_400 <EV_CQ1> T0_99 Y5_-3900 <EV_CQ1> Z2_-75 O0_243 Z2_-50 M-_99 WT?30 <EV_MoonVanish66> V4_2 <EV_BossActivate66> E0_20540 O0_1322 WT?30 D0_99;") //②雪球
	set_chr( 67,711,	 6, 5, 	   0,-450,200,		  1,   180, 5,"O0_1311 #8_99 M3_99 D0_167 T4_99 Y5_3100 #8_56 Y5_400 <EV_CQ1> T0_99 Y5_-3900 <EV_CQ1> Z2_-75 O0_243 Z2_-50 M-_99 WT?30 <EV_MoonVanish67> V4_3 <EV_BossActivate67> E0_20540 O0_1322 WT?30 D0_99;") //③雪球
	set_chr(166,991,	 4, 5, 	   0,-550,  0,		  1,070502, 0,";")
	set_chr(167,991,	 6, 5, 	   0,-550,  0,		  1,070502, 0,";")
	color2( 66, 100,75,25, 0, 0,0)	// 異次元の雪球の色（月っぽい）
	color2( 67, 100,75,25, 0, 0,0)	// 異次元の雪球の色（月っぽい）
//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++

	set_chr( 70,726,	 5, 8,     0, 290,-75,		  0,     0, 8,"WT?30 Y1_125 WT?20 ( Y1_-260 WT?20 Y1_260 WT?20 );")	//④移動床大（異）
	set_chr( 71,726,	 5, 8,     0,-290,-75,		  0,     0, 8,"WT?60 Y1_125 WT?20 ( Y1_-260 WT?20 Y1_260 WT?20 );")	//⑤移動床大（異）
	set_chr( 72,726,	 5, 6,     0,  25,-75,		  0,     0, 8,"WT?30 Y1_130 WT?20 ( Y1_-350 WT?20 Y1_350 WT?20 );")	//⑥移動床大（異）

//	if ( !F2185 )
	{
		set_chr( 74,632,	 5, 7,     0, 100,  0,		  2,    90, 0,"I_$$$1 F2185;") //⑤バリケード
	}

//	if ( !F2186 )
	{
		set_chr( 75,635,	 4, 7,     0,   0,  0,		  2,   270, 0,"I_$$$1 F2186;") //⑩顔の置物
	}

//	if ( !F2187 )
	{
		set_chr( 76,635,	 6, 7,     0,   0,  0,		  2,    90, 0,"I_$$$1 F2187;") //⑪顔の置物
	}

//■敵
//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
	set_chr(  2,304,	 4, 5, 	   0, -50,  0,		 -1,     0, 0,";")	//②敵 むーんぶりーど
	set_chr(  3,304,	 6, 5, 	   0, -50,  0,		 -1,     0, 0,";")	//③敵 むーんぶりーど

	set_chr(  5,280,	 4, 7,   300,   0,  0,		  2,   270, 0,";")	//①敵 でーもん
	set_chr(  6,280,	 6, 7,  -300,   0,  0,		  2,    90, 0,";")	//②敵 でーもん

	set_chr(  7,280,	 5, 5,  -900, 150,  0,		  2,   270, 0,";")	//⑥敵 でーもん
	set_chr(  8,280,	 5, 5,   900, 150,  0,		  2,    90, 0,";")	//⑦敵 でーもん

	set_chr( 16,146,	 5, 3,     0, 600,  0,		  2,   180, 0,";")	//⑧敵 がーでぃあん
	set_chr( 17,146,	 5, 4,     0,-900,  0,		  2,   180, 0,";")	//⑧敵 がーでぃあん
	set_chr( 18,146,	 5, 4,     0,-600,  0,		  2,   180, 0,";")	//⑧敵 がーでぃあん
	set_chr( 19,146,	 5, 4,     0,-300,  0,		  2,   180, 0,";")	//⑧敵 がーでぃあん

	set_chr( 12,151,	 5, 5,     0,   0,  0,		  2,   180, 0,";")	//⑨敵 そるじゃー
	set_chr( 13,151,	 5, 3,     0,-900,  0,		  2,   180, 0,";")	//⑩敵 そるじゃー

//■イベント

	// 雪球距離
	set_chr(181,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"      Ly?6800 SF110")
	set_chr(182,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"      Ly?6700 SF110")
	set_chr(183,990,	 0, 0,     0,   0,  0,		  0,     0, 9,"RF110 Ly?6600 SF110")

//■場面固有設定
}

//--------------------------------------------------------------------
EV_CQ1
{
	if (F110)
	{
		CAM_quake("4646")
	}
}

//--------------------------------------------------------------------
EV_MoonFall65
{
	jump(65,3, 60,-1,-1,-1200, 150)
	color(65, -10)
}

//--------------------------------------------------------------------
EV_MoonVanish65
{
	color(65, -30)
}

//--------------------------------------------------------------------
EV_MoonVanish66
{
	color(66, -30)
}

//--------------------------------------------------------------------
EV_MoonVanish67
{
	color(67, -30)
}

//--------------------------------------------------------------------
EV_BossActivate65
{
	if(IT_TAKARA<1)
	{
		set_chr( TAKARA_CH,560,		 5, 2,     0,   0,  0,		  6,     0,20,"<TK_TAKARA>;")		//②宝箱（並）
		set_chr(150,990, 	0, 0,     0,   0,  0,     0,     0, 8,"#3_49 F1 WT?10 <EV_BossBoxFall65> WT?25 #2_49;")
	}
	else
	{
		set_chr( TAKARA_CH,560,		 5, 2,     0,   0,  0,		  7,     0, 0,";")		//②宝箱（並）
		set_chr(150,990,	0, 0,     0,   0,  0,	  0,     0, 8,"#3_49 F1 WT?10 <EV_BossBoxFall65> WT?25;")
		F_set_chr( TAKARA_CH,		CF_NO_CSP)
	}
	chr_equip_chr( 49, 1,"Bone_Hips", 100,  90,0,0,		0, 0, 0);	//背負う箱
	color( 49,-1)		// 透明に
	F_set_chr( 49,		CF_NO_MINIMAP)	// 宝箱 ミニマップ非表示
	SE( 1322, 65 )
}

//--------------------------------------------------------------------
EV_BossFinish65
{
	color( 49,30)		// 不透明に
	F_reset_chr( 49,	CF_NO_MINIMAP)	// 宝箱 ミニマップ表示
}

//--------------------------------------------------------------------
EV_BossBoxFall65
{
	// 宝箱落下
	jump( 49,3, 24,-1,-1,0,150)
}

//--------------------------------------------------------------------
EV_BossActivate66
{
	SE( 1322, 66 )
}

//--------------------------------------------------------------------
EV_BossActivate67
{
	SE( 1322, 67 )
}

//--------------------------------------------------------------------
// EV_BossActivate65で生成する箱用なので専用のものが必要
//トレジャー発見
TK_TAKARA
{
	TK_begin()
	rot_chr(0,60,TAKARA_CH)

	MOT(TAKARA_CH,1,0)
	wait(30)
	fade_in(30,10,BLACK)
	get_item(IT_TAKARA,1,0)//謎トレジャー　鑑定前
	wait(10)
	wait_key(0)
	fade_in(0,10,BLACK)
	menu(1,		-1,	-1,-1,-1,	-1,-1,	10,0,0)
	menu(0,		-1,	-1,-1,-1,	-1,-1,	10,0,0)

	TK_end()
	
}

//--------------------------------------------------------------------
EV_SetGetFood1
{
	F_set(Fx_732Food1)
}

#EndScriptTable
//====================================================================

